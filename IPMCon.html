<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 IPM Construction | SPI-IPM Code Manual</title>
  <meta name="description" content="TBA." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 IPM Construction | SPI-IPM Code Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TBA." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 IPM Construction | SPI-IPM Code Manual" />
  
  <meta name="twitter:description" content="TBA." />
  

<meta name="author" content="ChloÃ© R. Nater" />


<meta name="date" content="2022-08-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="DataPrep.html"/>
<link rel="next" href="TempVar.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPI-IPM Code Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this manual</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i>How to cite</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="DataPrep.html"><a href="DataPrep.html"><i class="fa fa-check"></i><b>1</b> Preparing SPI-Birds data for Bayesian analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-count-data"><i class="fa fa-check"></i><b>1.1</b> Nest count data</a></li>
<li class="chapter" data-level="1.2" data-path="DataPrep.html"><a href="DataPrep.html#clutch-size-data"><i class="fa fa-check"></i><b>1.2</b> Clutch size data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level"><i class="fa fa-check"></i><b>1.2.1</b> Nest level</a></li>
<li class="chapter" data-level="1.2.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level"><i class="fa fa-check"></i><b>1.2.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="DataPrep.html"><a href="DataPrep.html#fledgling-count-data"><i class="fa fa-check"></i><b>1.3</b> Fledgling count data</a><ul>
<li class="chapter" data-level="1.3.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level-1"><i class="fa fa-check"></i><b>1.3.1</b> Nest level</a></li>
<li class="chapter" data-level="1.3.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level-1"><i class="fa fa-check"></i><b>1.3.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="DataPrep.html"><a href="DataPrep.html#mark-recapture-data"><i class="fa fa-check"></i><b>1.4</b> Mark-recapture data</a><ul>
<li class="chapter" data-level="1.4.1" data-path="DataPrep.html"><a href="DataPrep.html#individual-capture-histories"><i class="fa fa-check"></i><b>1.4.1</b> Individual capture histories</a></li>
<li class="chapter" data-level="1.4.2" data-path="DataPrep.html"><a href="DataPrep.html#m-array"><i class="fa fa-check"></i><b>1.4.2</b> M-array</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="DataPrep.html"><a href="DataPrep.html#immigrant-count-data"><i class="fa fa-check"></i><b>1.5</b> Immigrant count data</a></li>
<li class="chapter" data-level="1.6" data-path="DataPrep.html"><a href="DataPrep.html#auxiliary-data-on-the-sampling-process"><i class="fa fa-check"></i><b>1.6</b> Auxiliary data on the sampling process</a><ul>
<li class="chapter" data-level="1.6.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-survey-sampling-effort"><i class="fa fa-check"></i><b>1.6.1</b> Nest survey sampling effort</a></li>
<li class="chapter" data-level="1.6.2" data-path="DataPrep.html"><a href="DataPrep.html#capture-probability-proxies"><i class="fa fa-check"></i><b>1.6.2</b> Capture probability proxies</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="DataPrep.html"><a href="DataPrep.html#organisation-for-analysis-with-nimble"><i class="fa fa-check"></i><b>1.7</b> Organisation for analysis with NIMBLE</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="IPMCon.html"><a href="IPMCon.html"><i class="fa fa-check"></i><b>2</b> IPM Construction</a><ul>
<li class="chapter" data-level="2.1" data-path="IPMCon.html"><a href="IPMCon.html#open-population-model-with-2-age-classes"><i class="fa fa-check"></i><b>2.1</b> Open population model with 2 age classes</a><ul>
<li class="chapter" data-level="2.1.1" data-path="IPMCon.html"><a href="IPMCon.html#model-description"><i class="fa fa-check"></i><b>2.1.1</b> Model description</a></li>
<li class="chapter" data-level="2.1.2" data-path="IPMCon.html"><a href="IPMCon.html#code-implementation-including-demographic-stochasticity"><i class="fa fa-check"></i><b>2.1.2</b> Code implementation including demographic stochasticity</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="IPMCon.html"><a href="IPMCon.html#data-likelihoods"><i class="fa fa-check"></i><b>2.2</b> Data likelihoods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="IPMCon.html"><a href="IPMCon.html#nest-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.1</b> Nest count data likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="IPMCon.html"><a href="IPMCon.html#clutch-size-data-likelihoods"><i class="fa fa-check"></i><b>2.2.2</b> Clutch size data likelihoods</a></li>
<li class="chapter" data-level="2.2.3" data-path="IPMCon.html"><a href="IPMCon.html#fledgling-count-data-likelihoods"><i class="fa fa-check"></i><b>2.2.3</b> Fledgling count data likelihoods</a></li>
<li class="chapter" data-level="2.2.4" data-path="IPMCon.html"><a href="IPMCon.html#mark-recapture-data-likelihood"><i class="fa fa-check"></i><b>2.2.4</b> Mark-recapture data likelihood</a></li>
<li class="chapter" data-level="2.2.5" data-path="IPMCon.html"><a href="IPMCon.html#immigrant-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.5</b> Immigrant count data likelihood</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="IPMCon.html"><a href="IPMCon.html#priors-and-constraints"><i class="fa fa-check"></i><b>2.3</b> Priors and constraints</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="TempVar.html"><a href="TempVar.html"><i class="fa fa-check"></i><b>3</b> Modelling temporal variation</a><ul>
<li class="chapter" data-level="3.1" data-path="TempVar.html"><a href="TempVar.html#random-year-variation"><i class="fa fa-check"></i><b>3.1</b> Random year variation</a></li>
<li class="chapter" data-level="3.2" data-path="TempVar.html"><a href="TempVar.html#temporal-covariates"><i class="fa fa-check"></i><b>3.2</b> Temporal covariates</a><ul>
<li class="chapter" data-level="3.2.1" data-path="TempVar.html"><a href="TempVar.html#continuous-variables"><i class="fa fa-check"></i><b>3.2.1</b> Continuous variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="TempVar.html"><a href="TempVar.html#categorical-variables"><i class="fa fa-check"></i><b>3.2.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="TempVar.html"><a href="TempVar.html#imputation-of-missing-covariate-values"><i class="fa fa-check"></i><b>3.2.3</b> Imputation of missing covariate values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="TempVar.html"><a href="TempVar.html#notes-on-covariate-selection"><i class="fa fa-check"></i><b>3.3</b> Notes on covariate selection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="IPMImp.html"><a href="IPMImp.html"><i class="fa fa-check"></i><b>4</b> IPM Implementation</a><ul>
<li class="chapter" data-level="4.1" data-path="IPMImp.html"><a href="IPMImp.html#efficient-implementation-using-nimble"><i class="fa fa-check"></i><b>4.1</b> Efficient implementation using NIMBLE</a><ul>
<li class="chapter" data-level="4.1.1" data-path="IPMImp.html"><a href="IPMImp.html#alternative-specification-of-distributions"><i class="fa fa-check"></i><b>4.1.1</b> Alternative specification of distributions</a></li>
<li class="chapter" data-level="4.1.2" data-path="IPMImp.html"><a href="IPMImp.html#vectorized-calculations"><i class="fa fa-check"></i><b>4.1.2</b> Vectorized calculations</a></li>
<li class="chapter" data-level="4.1.3" data-path="IPMImp.html"><a href="IPMImp.html#custom-distributions"><i class="fa fa-check"></i><b>4.1.3</b> Custom distributions</a></li>
<li class="chapter" data-level="4.1.4" data-path="IPMImp.html"><a href="IPMImp.html#calling-nimble-from-r"><i class="fa fa-check"></i><b>4.1.4</b> Calling NIMBLE from R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="IPMImp.html"><a href="IPMImp.html#simulation-of-initial-values"><i class="fa fa-check"></i><b>4.2</b> Simulation of initial values</a></li>
<li class="chapter" data-level="4.3" data-path="IPMImp.html"><a href="IPMImp.html#test-runs-and-full-runs-chains-iterations-burn-in-and-thinning"><i class="fa fa-check"></i><b>4.3</b> Test runs and full runs: chains, iterations, burn-in, and thinning</a></li>
<li class="chapter" data-level="4.4" data-path="IPMImp.html"><a href="IPMImp.html#trouble-shooting-implementation-issues"><i class="fa fa-check"></i><b>4.4</b> Trouble-shooting implementation issues</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ModelAssm.html"><a href="ModelAssm.html"><i class="fa fa-check"></i><b>5</b> Model Assessment</a><ul>
<li class="chapter" data-level="5.1" data-path="ModelAssm.html"><a href="ModelAssm.html#assessing-chain-convergence"><i class="fa fa-check"></i><b>5.1</b> Assessing chain convergence</a></li>
<li class="chapter" data-level="5.2" data-path="ModelAssm.html"><a href="ModelAssm.html#plotting-data-vs.-predictions"><i class="fa fa-check"></i><b>5.2</b> Plotting data vs.Â predictions</a></li>
<li class="chapter" data-level="5.3" data-path="ModelAssm.html"><a href="ModelAssm.html#comparing-estimates-from-integrated-vs.-independent-analyses"><i class="fa fa-check"></i><b>5.3</b> Comparing estimates from integrated vs.Â independent analyses</a></li>
<li class="chapter" data-level="5.4" data-path="ModelAssm.html"><a href="ModelAssm.html#reality-check-using-stochastic-simulations"><i class="fa fa-check"></i><b>5.4</b> âReality checkâ using stochastic simulations</a></li>
<li class="chapter" data-level="5.5" data-path="ModelAssm.html"><a href="ModelAssm.html#other-approaches"><i class="fa fa-check"></i><b>5.5</b> Other approaches</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ResultsViz.html"><a href="ResultsViz.html"><i class="fa fa-check"></i><b>6</b> Visualizing and interpreting direct IPM outputs</a><ul>
<li class="chapter" data-level="6.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-trajectories"><i class="fa fa-check"></i><b>6.1</b> Population trajectories</a></li>
<li class="chapter" data-level="6.2" data-path="ResultsViz.html"><a href="ResultsViz.html#within-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.2</b> Within-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ResultsViz.html"><a href="ResultsViz.html#age-class-specific-averages"><i class="fa fa-check"></i><b>6.2.1</b> Age-class-specific averages</a></li>
<li class="chapter" data-level="6.2.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation"><i class="fa fa-check"></i><b>6.2.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ResultsViz.html"><a href="ResultsViz.html#between-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.3</b> Between-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-specific-averages"><i class="fa fa-check"></i><b>6.3.1</b> Population-specific averages</a></li>
<li class="chapter" data-level="6.3.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation-1"><i class="fa fa-check"></i><b>6.3.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ResultsViz.html"><a href="ResultsViz.html#covariate-effects"><i class="fa fa-check"></i><b>6.4</b> Covariate effects</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="AddAnalyses.html"><a href="AddAnalyses.html"><i class="fa fa-check"></i><b>7</b> Follow-up Analyses</a><ul>
<li class="chapter" data-level="7.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-time-trends"><i class="fa fa-check"></i><b>7.1</b> Testing for time-trends</a></li>
<li class="chapter" data-level="7.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-density-dependence"><i class="fa fa-check"></i><b>7.2</b> Testing for density-dependence</a></li>
<li class="chapter" data-level="7.3" data-path="AddAnalyses.html"><a href="AddAnalyses.html#investigating-cross-population-covariation"><i class="fa fa-check"></i><b>7.3</b> Investigating cross-population covariation</a></li>
<li class="chapter" data-level="7.4" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-short-term-population-dynamics"><i class="fa fa-check"></i><b>7.4</b> Quantifying demographic contributions to short term population dynamics</a><ul>
<li class="chapter" data-level="7.4.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-by-year-variation-in-population-growth-rate-random-design-ltre"><i class="fa fa-check"></i><b>7.4.1</b> Year-by-year variation in population growth rate (random design LTRE)</a></li>
<li class="chapter" data-level="7.4.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-to-year-differences-in-population-growth-rate-fixed-design-ltre"><i class="fa fa-check"></i><b>7.4.2</b> Year-to-year differences in population growth rate (fixed design LTRE)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-long-term-population-trends"><i class="fa fa-check"></i><b>7.5</b> Quantifying demographic contributions to long-term population trends</a><ul>
<li class="chapter" data-level="7.5.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#differences-in-population-trajectories-between-time-periods-period-design-ltre"><i class="fa fa-check"></i><b>7.5.1</b> Differences in population trajectories between time periods (period design LTRE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ExtOutlook.html"><a href="ExtOutlook.html"><i class="fa fa-check"></i><b>8</b> Useful extensions and outlook</a><ul>
<li class="chapter" data-level="8.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#adapting-the-population-model-for-your-speciespopulation"><i class="fa fa-check"></i><b>8.1</b> Adapting the population model for your species/population</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#accounting-for-multiple-broods-per-bird-per-year"><i class="fa fa-check"></i><b>8.1.1</b> Accounting for multiple broods per bird per year</a></li>
<li class="chapter" data-level="8.1.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#altering-age-structure"><i class="fa fa-check"></i><b>8.1.2</b> Altering age structure</a></li>
<li class="chapter" data-level="8.1.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#individual-heterogeneity-beyond-age-sex-traits-and-more"><i class="fa fa-check"></i><b>8.1.3</b> Individual heterogeneity beyond age: sex, traits, and more</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-additional-data-and-informative-priors"><i class="fa fa-check"></i><b>8.2</b> Including additional data and informative priors</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-partially-observed-age-information"><i class="fa fa-check"></i><b>8.2.1</b> Including partially observed age information</a></li>
<li class="chapter" data-level="8.2.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#making-the-most-of-auxiliary-knowledge-about-immigrantsdispersers"><i class="fa fa-check"></i><b>8.2.2</b> Making the most of auxiliary knowledge about immigrants/dispersers</a></li>
<li class="chapter" data-level="8.2.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#letting-published-values-help-with-estimation-when-data-is-sparse"><i class="fa fa-check"></i><b>8.2.3</b> Letting published values help with estimation when data is sparse</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#building-on-the-multi-population-perspective"><i class="fa fa-check"></i><b>8.3</b> Building on the multi-population perspective</a><ul>
<li class="chapter" data-level="8.3.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#joint-analysis-of-data-from-several-populations"><i class="fa fa-check"></i><b>8.3.1</b> Joint analysis of data from several populations</a></li>
<li class="chapter" data-level="8.3.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#modelling-cross-population-covariation"><i class="fa fa-check"></i><b>8.3.2</b> Modelling cross-population covariation</a></li>
<li class="chapter" data-level="8.3.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#estimating-hyper-parameters-in-large-scale-analyses"><i class="fa fa-check"></i><b>8.3.3</b> Estimating hyper-parameters in large-scale analyses</a></li>
<li class="chapter" data-level="8.3.4" data-path="ExtOutlook.html"><a href="ExtOutlook.html#unlocking-the-secrets-of-dispersal"><i class="fa fa-check"></i><b>8.3.4</b> Unlocking the secrets of dispersal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SPI-IPM Code Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="IPMCon" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 2</span> IPM Construction<a href="IPMCon.html#IPMCon" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="open-population-model-with-2-age-classes" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.1</span> Open population model with 2 age classes<a href="IPMCon.html#open-population-model-with-2-age-classes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="model-description" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.1.1</span> Model description<a href="IPMCon.html#model-description" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Population dynamics are represented using a female-based age-structured open
population model with a pre-breeding census in spring. At census, females are
divided into two age classes: âyearlingsâ (1-year old birds hatched during the
breeding season of the previous year) and âadultsâ (birds older than one year).
The motivation underlying this distinction is that reproductive output often
differs for these two age classes in passerine birds.
The dynamics of the female segment of the population over the time-interval from
census in year <span class="math inline">\(t\)</span> to census in year <span class="math inline">\(t+1\)</span> can be described with classic matrix
notation <span class="citation">(Caswell <a href="#ref-Caswell2001" role="doc-biblioref">2001</a>)</span> as:</p>
<p><br />
<span class="math display">\[N_{tot,t+1} = \begin{bmatrix} N_{Y,t+1} \\ N_{A,t+1} \end{bmatrix} =
  \begin{bmatrix}
0.5F_{Y,t}sJ_t &amp; 0.5F_{A,t}sJ_t \\
sA_t &amp; sA_t
\end{bmatrix}\begin{bmatrix} N_{Y,t} \\ N_{A,t} \end{bmatrix} +
  \begin{bmatrix} Imm_{Y,t+1} \\ Imm_{A,t+1} \end{bmatrix}\]</span><br />
</p>
<p><span class="math inline">\(N_{tot,t+1}\)</span> represents the total number of yearling and adult females in the
population upon arrival in the breeding areas in year t. The total female
population size, <span class="math inline">\(N_{tot,t+1}\)</span>, is the sum of the numbers of yearling and adult
females in the population in year <span class="math inline">\(t+1\)</span> (<span class="math inline">\(N_{Y,t+1}\)</span> and <span class="math inline">\(N_{A,t+1}\)</span>,
respectively) and consists of local survivors and recruits from the previous
breeding season, as well as immigrant yearling (<span class="math inline">\(Imm_{Y,t+1}\)</span>) and adult
(<span class="math inline">\(Imm_{A,t+1}\)</span>) females.<br />
</p>
<p><span class="math inline">\(F_{a,t}\)</span> represents the expected number of fledglings produced by age class <span class="math inline">\(a\)</span>
females during the breeding season in year <span class="math inline">\(t\)</span> and is the product of several
vital rates. First, females in age class a may breed in a nestbox with
probability <span class="math inline">\(pB_{a,t}\)</span> upon arrival to breeding areas in year <span class="math inline">\(t\)</span>. Each breeding
female may then lay a clutch containing a certain number of eggs (expected
number = <span class="math inline">\(CS_{a,t}\)</span>), and each egg within the clutch may hatch and survive to
fledging. The probability of an egg hatching and surviving to fledging is
divided into an age-independent probability of nest success (<span class="math inline">\(pNS_t\)</span>,
probability of complete clutch failure = <span class="math inline">\(1-pNS_t\)</span>) and a survival probability
of every egg/chick to fledging provided that the nest has not failed entirely
(<span class="math inline">\(sN_{a,t}\)</span>, with <span class="math inline">\(a\)</span> = age of the mother). Consequently, the expected number of
fledglings produced by age class <span class="math inline">\(a\)</span> females in year t is defined as:</p>
<p><span class="math display">\[\begin{equation}
F_{a,t}= pB_{a,t}\times CS_{a,t}\times pNS_{t}\times sN_{a,t}
\end{equation}\]</span></p>
<p>Fledglings that survive to the next breeding season and remain within the
population (apparent survival probability = <span class="math inline">\(sJ_t\)</span>) contribute to next yearâs yearling class
(<span class="math inline">\(N_{Y,t+1}\)</span>). Yearlings and adults that survive to the next breeding season and
remain within the population (apparent survival probability = <span class="math inline">\(sA_t\)</span>) become part of next yearâs
adult age class (<span class="math inline">\(N_{A,t+1}\)</span>).</p>
</div>
<div id="code-implementation-including-demographic-stochasticity" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.1.2</span> Code implementation including demographic stochasticity<a href="IPMCon.html#code-implementation-including-demographic-stochasticity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Population process models within IPMs are typically implemented as stochastic
models that account for randomness in the outcomes of demographic processes at
the individual level <span class="citation">(âdemographic stochasticityâ, Caswell <a href="#ref-Caswell2001" role="doc-biblioref">2001</a>; KÃ©ry and Schaub <a href="#ref-kery2011" role="doc-biblioref">2011</a>)</span>.
The model described here is no different, meaning that the numbers of breeders,
fledglings, and survivors are treated as binomial and Poisson random variables.</p>
<p>Reproduction is modelled via two sets of random variables: a binomial random
variable representing the number of breeders in age class <span class="math inline">\(a\)</span> in year <span class="math inline">\(t\)</span>,
<span class="math inline">\(B_{a,t}\)</span> and a Poisson random variable representing the
number of fledlings produced by breeders of age class <span class="math inline">\(a\)</span> in year <span class="math inline">\(t\)</span>,
<span class="math inline">\(Juv_{a,t}\)</span> . The implementation in the BUGS language used in the
SPI-IPM code (<a href="https://github.com/SPI-Birds/SPI-IPM/blob/main/SPI-IPM_Code/02-04_IPM_Setup&amp;Run/IPMSetup.R"><code>IPMSetup.R</code></a>, lines 231-241) looks like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="IPMCon.html#cb1-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb1-2"><a href="IPMCon.html#cb1-2"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb1-3"><a href="IPMCon.html#cb1-3"></a>    </span>
<span id="cb1-4"><a href="IPMCon.html#cb1-4"></a>    <span class="co">## 1) Breeding decision</span></span>
<span id="cb1-5"><a href="IPMCon.html#cb1-5"></a>    B[a,t] <span class="op">~</span><span class="st"> </span><span class="kw">dbin</span>(pB[a,t], N[a,t])</span>
<span id="cb1-6"><a href="IPMCon.html#cb1-6"></a>    </span>
<span id="cb1-7"><a href="IPMCon.html#cb1-7"></a>    <span class="co">## 2) Offspring production</span></span>
<span id="cb1-8"><a href="IPMCon.html#cb1-8"></a>    Juv[a,t] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(B[a,t]<span class="op">*</span>CS[a,t]<span class="op">*</span>pNS[t]<span class="op">*</span>sN[a,t]<span class="op">*</span><span class="fl">0.5</span>)</span>
<span id="cb1-9"><a href="IPMCon.html#cb1-9"></a>  }</span>
<span id="cb1-10"><a href="IPMCon.html#cb1-10"></a>}</span></code></pre></div>
<p>In the code, the age indeces <span class="math inline">\(a=1\)</span> and <span class="math inline">\(a=A=2\)</span> correspond to yearlings and
adults, respectively.</p>
<p>Analogous to breeders, the numbers of local survivors â both fledglings surviving their
first year and becoming yearlings, and yearlings and adults surviving to the
next year â are implemented as binomial random variables (<a href="https://github.com/SPI-Birds/SPI-IPM/blob/main/SPI-IPM_Code/02-04_IPM_Setup&amp;Run/IPMSetup.R"><code>IPMSetup.R</code></a>, lines 243-255):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="IPMCon.html#cb2-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(Tmax<span class="dv">-1</span>)){</span>
<span id="cb2-2"><a href="IPMCon.html#cb2-2"></a>  </span>
<span id="cb2-3"><a href="IPMCon.html#cb2-3"></a>  <span class="co">## 3) Annual survival of local birds</span></span>
<span id="cb2-4"><a href="IPMCon.html#cb2-4"></a>  <span class="co"># Juveniles -&gt; Yearlings</span></span>
<span id="cb2-5"><a href="IPMCon.html#cb2-5"></a>  localN[<span class="dv">1</span>,t<span class="op">+</span><span class="dv">1</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dbin</span>(sJ[t], <span class="kw">sum</span>(Juv[<span class="dv">1</span><span class="op">:</span>A,t]))</span>
<span id="cb2-6"><a href="IPMCon.html#cb2-6"></a>  <span class="co"># Yearlings/Adults -&gt; adults</span></span>
<span id="cb2-7"><a href="IPMCon.html#cb2-7"></a>  localN[<span class="dv">2</span>,t<span class="op">+</span><span class="dv">1</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dbin</span>(sA[t], <span class="kw">sum</span>(N[<span class="dv">1</span><span class="op">:</span>A,t]))</span>
<span id="cb2-8"><a href="IPMCon.html#cb2-8"></a>  </span>
<span id="cb2-9"><a href="IPMCon.html#cb2-9"></a>  <span class="co">## 4) Immigration</span></span>
<span id="cb2-10"><a href="IPMCon.html#cb2-10"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb2-11"><a href="IPMCon.html#cb2-11"></a>    N[a,t<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>localN[a,t<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>Imm[a,t<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2-12"><a href="IPMCon.html#cb2-12"></a>  }</span>
<span id="cb2-13"><a href="IPMCon.html#cb2-13"></a>}</span></code></pre></div>
<p>Immigrant numbers are also treated as outcomes of stochastic processes, and
these are detailed in <a href="###%20Immigrant%20count%20data%20likelihood">2.2.5 Immigrant count data likelihood</a>.</p>
</div>
</div>
<div id="data-likelihoods" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.2</span> Data likelihoods<a href="IPMCon.html#data-likelihoods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>IPMs obtain information on the population modelâs parameters (population sizes
and vital rates) from several different data sets. Information in each data set
is channeled into model parameters via one or multiple data likelihoods.<br />
The SPI-IPM contains five data modules consisting of a total of eight data
likelihoods: nest count data (one likelihood), clutch size data (two likelihoods),
fledgling count data (three likelihoods), mark-recapture data (one likelihood),
and immigrant count data (one likelihood).
The likelihoods contained in each data module are described in detail in the
following sub-chapters. The underlying data sets are introduced in
<a href="DataPrep.html#DataPrep">Chapter 1</a> of the manual.</p>
<div id="nest-count-data-likelihood" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.1</span> Nest count data likelihood<a href="IPMCon.html#nest-count-data-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The population model defines the true size of the female segment of the breeding
population in any year <span class="math inline">\(t\)</span> via the year- and age-specific number of breeding
females:</p>
<p><span class="math display">\[\begin{equation}
B_{a,t}  \sim Binomial(N_{a,t}, pB_{a,t})
\end{equation}\]</span></p>
<p>The total size of the female breeding population (the sum of <span class="math inline">\(B_{a,t}\)</span> over all
age classes) in year <span class="math inline">\(t\)</span> is expected to correspond closely with the observed
number of first clutches laid in any year (<span class="math inline">\(NestCount_t\)</span>).
The breeding population count thus contains information about both breeding
probability (<span class="math inline">\(pB_{a,t}\)</span>) and population size (<span class="math inline">\(N_{a,t}\)</span>) and its likelihood can
be defined as:</p>
<p><span class="math display">\[\begin{equation}
NestCount_t  \sim Poisson((B_{Y,t} + B_{A,t}) \times NS\_Data_t)
\end{equation}\]</span></p>
<p>Here, the year-specific variable <span class="math inline">\(NS\_Data_t\)</span> is a correction factor introduced
for dealing with years in which no nest survey data was collected
(<span class="math inline">\(NestCount_t = 0\)</span> due to lack of sampling). <span class="math inline">\(NS\_Data_t\)</span> is set to 0 for years
without data collection, and to 1 in all other years.</p>
<p>The likelihood is written almost identically in the code, the only difference
being the use the <code>sum()</code> function over age classes <span class="math inline">\(1\)</span> to <span class="math inline">\(A=2\)</span> when
specifying the Poisson distribution (this provides more flexibility for
extending the model to more than two age classes):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="IPMCon.html#cb3-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb3-2"><a href="IPMCon.html#cb3-2"></a>  NestCount[t] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(<span class="kw">sum</span>(B[<span class="dv">1</span><span class="op">:</span>A,t])<span class="op">*</span>NS_Data[t])</span>
<span id="cb3-3"><a href="IPMCon.html#cb3-3"></a>}</span></code></pre></div>
</div>
<div id="clutch-size-data-likelihoods" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.2</span> Clutch size data likelihoods<a href="IPMCon.html#clutch-size-data-likelihoods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The counting of incubated eggs provides information about both individual-level
clutch size (<span class="math inline">\(CS_{a,t}\)</span>) and reproductive output at the population level.
Consequently, two separate likelihoods can be specified for within the clutch
size data module.</p>
<p>Each individual clutch size observation can be treated as the outcome of a
Poisson process with an expected value of <span class="math inline">\(CS_{a,t}\)</span> (where <span class="math inline">\(a\)</span> is the age of
the female that laid the clutch, and <span class="math inline">\(t\)</span> the year in which the clutch was laid).
In the code, the likelihood is formulated for each clutch size observation <span class="math inline">\(x\)</span>
(out of a total of <code>CS_X</code> observations) and includes nested indexing of the
expectation using data on female age (<code>CS_FAge</code>) and year (<code>CS_year</code>):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="IPMCon.html#cb4-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>CS_X){</span>
<span id="cb4-2"><a href="IPMCon.html#cb4-2"></a>    ClutchSize[x] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(CS[CS_FAge[x], CS_year[x]])</span>
<span id="cb4-3"><a href="IPMCon.html#cb4-3"></a>}</span></code></pre></div>
<p>Since both year and female age need to be part of the provided data, the
individual-level clutch size likelihood can only be used with complete
observations, i.e.Â clutches for which both number of eggs and age of the mother
are known (year should always be known).</p>
<p>For the population-level likelihood, on the other hand, data on clutch sizes can
be included irrespective of whether the age of the mother is known. The total
number of eggs counted in all nests laid in year <span class="math inline">\(t\)</span> can be described as:</p>
<p><span class="math display">\[\begin{equation}
EggNoTot_t \sim Poisson(sum(B_{Y:A,t} \times CS_{Y:A,t}) \times p_t^{EggNo})
\end{equation}\]</span></p>
<p>Since the product <span class="math inline">\(B_{a,t} \times CS_{a,t}\)</span> corresponds to all eggs laid in all nests/nestboxes within the study site, another correction factor (<span class="math inline">\(p_t^{EggNo}\)</span>) is needed to account for the fact that eggs may not have been counted in all surveyed nests with breeding activity in each year. <span class="math inline">\(p_t^{EggNo}\)</span> (<code>EggNoSP[t]</code> in code) thus contains information of the year-specific proportionof surveyed nests for which the numbers of eggs were counted.</p>
<p>In code, the likelihood for the number of eggs at the population is written as:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="IPMCon.html#cb5-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb5-2"><a href="IPMCon.html#cb5-2"></a></span>
<span id="cb5-3"><a href="IPMCon.html#cb5-3"></a>    <span class="co"># Expected &quot;true&quot; egg number (by mother age class)</span></span>
<span id="cb5-4"><a href="IPMCon.html#cb5-4"></a>    EggNo.ex[<span class="dv">1</span><span class="op">:</span>A,t] &lt;-<span class="st"> </span>B[<span class="dv">1</span><span class="op">:</span>A,t]<span class="op">*</span>CS[<span class="dv">1</span><span class="op">:</span>A,t]</span>
<span id="cb5-5"><a href="IPMCon.html#cb5-5"></a></span>
<span id="cb5-6"><a href="IPMCon.html#cb5-6"></a>    <span class="co"># Observed egg number (corrected by data availaility)</span></span>
<span id="cb5-7"><a href="IPMCon.html#cb5-7"></a>    EggNoTot[t] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(<span class="kw">sum</span>(EggNo.ex[<span class="dv">1</span><span class="op">:</span>A,t])<span class="op">*</span>EggNoSP[t])</span>
<span id="cb5-8"><a href="IPMCon.html#cb5-8"></a></span>
<span id="cb5-9"><a href="IPMCon.html#cb5-9"></a>}</span></code></pre></div>
</div>
<div id="fledgling-count-data-likelihoods" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.3</span> Fledgling count data likelihoods<a href="IPMCon.html#fledgling-count-data-likelihoods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Analogous to observations of clutch size, counts of fledglings contain
information on reproduction at both individual and population level.
Distributions of number of fledglings produced from a clutch are often 0-inflated
because incidents of harsh weather, predation, adandonment, etc. may result in
complete loss of entire clutches. To account for this, we split data on fledgling
numbers and formulated separate likelihoods for the survival of the clutch as
a whole (probability of a nest not failing completely, <span class="math inline">\(pNS_t\)</span>) and for each
chick subsequently surviving to fledgling (probability <span class="math inline">\(sN_{a,t}\)</span>).<br />
Whether or not a clutch succeeded (i.e.Â at least one chick survived to fledging,
<code>anyFledged</code>) was coded using 1 (success) and 0 (failure) and modelled as the
outcome of a Bernoulli process with a year-dependent success probability <span class="math inline">\(pNS_t\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="IPMCon.html#cb6-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>F_X){</span>
<span id="cb6-2"><a href="IPMCon.html#cb6-2"></a>  anyFledged[x] <span class="op">~</span><span class="st"> </span><span class="kw">dbern</span>(pNS[F_year[x]])</span>
<span id="cb6-3"><a href="IPMCon.html#cb6-3"></a>}</span></code></pre></div>
<p>For the subset of successful clutches, the number of fledglings produced
(<code>NoFledged</code>) was modelled as a binomial random variable with each egg laid in
the clutch (<code>NoLaid</code>) having a probability of <span class="math inline">\(sN_{a,t}\)</span> (where <span class="math inline">\(a\)</span> = age of the
mother) to survive and fledge:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="IPMCon.html#cb7-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NoF_X){</span>
<span id="cb7-2"><a href="IPMCon.html#cb7-2"></a>    NoFledged[x] <span class="op">~</span><span class="st"> </span><span class="kw">dbin</span>(sN[NoF_FAge[x], NoF_year[x]], NoLaid[x])</span>
<span id="cb7-3"><a href="IPMCon.html#cb7-3"></a>}</span></code></pre></div>
<p>At the population level, both processes (nest success and survival to fledging
conditional on nest success) were combined into a single Poisson
likelihood describing the total number of fledglings counted in the population
in a given year <span class="math inline">\(t\)</span> as the product of the number of breeding females, clutch
size, nest success, and survival to fledging:</p>
<p><span class="math display">\[\begin{equation}
FledgedTot_t  \sim Poisson(sum(B_{Y:A,t}\times CS_{Y:A,t}\times pNS_t\times sN_{Y:A,t}) \times p_t^{Fledged})
\end{equation}\]</span></p>
<p>As in the clutch size data module (<a href="###%20Clutch%20size%20data%20likelihoods">Chapter 2.2.2</a>),
a correction factor quantifying the proportion of nests for which data is
availeble (<span class="math inline">\(p_t^{Fledged}\)</span>, <code>FledgedSP[t]</code> in code) is used to account for
missing records of fledgling numbers.</p>
<p>In the code, calculation of the expected number of fledglings is based on the expected number of eggs as calculated in the clutch size data module
(<a href="###%20Clutch%20size%20data%20likelihoods">Chapter 2.2.2</a>):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="IPMCon.html#cb8-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb8-2"><a href="IPMCon.html#cb8-2"></a></span>
<span id="cb8-3"><a href="IPMCon.html#cb8-3"></a>    <span class="co"># Expected &quot;true&quot; fledgling number (by mother age class)</span></span>
<span id="cb8-4"><a href="IPMCon.html#cb8-4"></a>    Fledged.ex[<span class="dv">1</span><span class="op">:</span>A,t] &lt;-<span class="st"> </span>EggNo.ex[<span class="dv">1</span><span class="op">:</span>A,t]<span class="op">*</span>pNS[t]<span class="op">*</span>sN[<span class="dv">1</span><span class="op">:</span>A,t]</span>
<span id="cb8-5"><a href="IPMCon.html#cb8-5"></a></span>
<span id="cb8-6"><a href="IPMCon.html#cb8-6"></a>    <span class="co"># Observed egg number (corrected by data availaility)</span></span>
<span id="cb8-7"><a href="IPMCon.html#cb8-7"></a>    FledgedTot[t] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(<span class="kw">sum</span>(Fledged.ex[<span class="dv">1</span><span class="op">:</span>A,t])<span class="op">*</span>FledgedSP[t])</span>
<span id="cb8-8"><a href="IPMCon.html#cb8-8"></a>}</span></code></pre></div>
</div>
<div id="mark-recapture-data-likelihood" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.4</span> Mark-recapture data likelihood<a href="IPMCon.html#mark-recapture-data-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the SPI-IPM, capture histories of marked birds are analysed using an age-specific Cormack-Jolly-Seber (CJS) model <span class="citation">(Cormack <a href="#ref-cormack1964" role="doc-biblioref">1964</a>; Jolly <a href="#ref-jolly1965" role="doc-biblioref">1965</a>; Seber <a href="#ref-seber1965" role="doc-biblioref">1965</a>)</span>, which allows estimation of parameters associated with both annual survival and the (re-)capturing process.<br />
The apparent survival parameters <span class="math inline">\(sJ_t\)</span> and <span class="math inline">\(sA_t\)</span> describe the probability of surviving from one breeding season to the next and remaining in the study population for fledglings/juveniles and adult females, respectively. Since field-based sexing fledglings is not possible in the hatch year, first-year survival in the CJS likelihood was set to <span class="math inline">\(0.5sJ_t\)</span>, representing the probability that a fledgling is female and survives (recaptures of adult males were removed from the capture histories).<br />
The time- and age-dependent recapture parameters <span class="math inline">\(p_{Age,t}^{Recap}\)</span> describe the probability that an age class <span class="math inline">\(a\)</span> individual is recaptured and identified during the breeding season of year <span class="math inline">\(t\)</span> given that it survived the time interval <span class="math inline">\(t-1\)</span> to <span class="math inline">\(t\)</span>. For many of the bird populations included in SPI-Birds, (re-)captures of birds are carried out at the nestboxes during the breeding season only. Consequently, two conditions need to be met for a (re-)capture besides the individual being alive: 1) the individual breeds in a nestbox (as non-breeders and birds breeding in natural cavities are not captured) and 2) the individual is actually captured and marked/identified while breeding in a nestbox. The recapture probability is therefore the product of the probability of breeding in a nestbox (<span class="math inline">\(pB_{Age,t}\)</span>) and the probability of capture and identification given breeding in a nestbox (<span class="math inline">\(p_t^{CapB}\)</span>):
<span class="math display">\[\begin{equation}
  p_{Age,t}^{Recap}=pB_{Age,t}\times p_t^{CapB}
\end{equation}\]</span>
The parameters <span class="math inline">\(pB_{Age,t}\)</span> and <span class="math inline">\(p_t^{CapB}\)</span> are confounded, and auxiliary data on one of them is required to separately estimate them. Here, raw data on the annual proportions of surveyed nests for which the identity of the breeding female was recorded (as a result of ringing or recapture) is used to approximated <span class="math inline">\(p_t^{CapB}\)</span>, allowing the CJS model to estimate age- and time-specific breeding probabilities (<span class="math inline">\(pB_{Age,t}\)</span>).<br />
CJS models in Bayesian frameworks have traditionally been implemented either as latent states models with Bernouilli likelihoods or as multinomial likelihoods for data re-formatted as âm-arraysâ <span class="citation">(Gimenez et al. <a href="#ref-gimenez2007" role="doc-biblioref">2007</a>; KÃ©ry and Schaub <a href="#ref-kery2011" role="doc-biblioref">2011</a>)</span>. The former typically results in long runtimes and high computational costs, while the improved efficiency of the latter is tied to an implementation that suffers from being neither particularly intuitive nor user-friendly. To avoid these pitfalls, the CJS model in the SPI-IPM is implemented using a much more efficient marginalized likelihood (that integrates over all latent states) that can be applied to unique (not individual) capture histories only <span class="citation">(following Turek, de Valpine, and Paciorek <a href="#ref-turek2016" role="doc-biblioref">2016</a>)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="IPMCon.html#cb9-1"></a><span class="co">## Likelihood with custom distribution</span></span>
<span id="cb9-2"><a href="IPMCon.html#cb9-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.CH){</span>
<span id="cb9-3"><a href="IPMCon.html#cb9-3"></a></span>
<span id="cb9-4"><a href="IPMCon.html#cb9-4"></a>  y.sum[i, first.sum[i]<span class="op">:</span>last.sum[i]] <span class="op">~</span><span class="st"> </span><span class="kw">dCJS_vv_sum</span>(</span>
<span id="cb9-5"><a href="IPMCon.html#cb9-5"></a>      <span class="dt">probSurvive =</span> phi.CH[i, first.sum[i]<span class="op">:</span>last.sum[i]],</span>
<span id="cb9-6"><a href="IPMCon.html#cb9-6"></a>      <span class="dt">probCapture =</span> p.CH[i, first.sum[i]<span class="op">:</span>last.sum[i]],</span>
<span id="cb9-7"><a href="IPMCon.html#cb9-7"></a>      <span class="dt">len =</span> last.sum[i]<span class="op">-</span>first.sum[i]<span class="op">+</span><span class="dv">1</span>,</span>
<span id="cb9-8"><a href="IPMCon.html#cb9-8"></a>      <span class="dt">mult =</span> CHs.count[i])</span>
<span id="cb9-9"><a href="IPMCon.html#cb9-9"></a>}</span></code></pre></div>
<p>In practice, this involves the use of a custom distribution <code>dCJS_vv_sum</code>, and more information on the likelihood and its implementation using NIMBLE is provided in <a href="##%20Efficient%20implementation%20using%20NIMBLE">Chapter 4.1 (Efficient implementation using NIMBLE)</a>.</p>
</div>
<div id="immigrant-count-data-likelihood" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.5</span> Immigrant count data likelihood<a href="IPMCon.html#immigrant-count-data-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many nestbox studies, chick ringing is an exhaustive effort and it is not unreasonable to assume that all chicks hatched in nestboxes within a study population are ringed before fledging. Similarly, assuming that females captured in nestboxes are breeding (or attempting to breed) is often not far from the truth. If those two assumptions are largely met, then the annual numbers of newly ringed adult females (<span class="math inline">\(ImmNoObs_t\)</span>) can provide information about immigration or â more specifically â about the latent number of newly immigrated females breeding in nestboxes each year (<span class="math inline">\(ImmNoTot_t\)</span>). Typically, age will be unknown for immigrant females (unless they were marked as chicks elsewhere) and hence there is no age index on <span class="math inline">\(ImmNoObs_t\)</span> and <span class="math inline">\(ImmNoTot_t\)</span>. In <code>SPI-IPM</code>, we use a Poisson observation model to describe the relationship between observed and true numbers of breeding immigrant females:
<span class="math display">\[\begin{equation}
  ImmNoObs_t \sim Poisson(ImmNoTot_t \times p_t^{ImmDetect})
\end{equation}\]</span>
The expected value represents the true number of female breeding immigrants in year <span class="math inline">\(t\)</span> (<span class="math inline">\(ImmNoTot_t\)</span>) corrected by an annual probability of detecting (= ringing) such individuals (<span class="math inline">\(p_t^{ImmDetect}\)</span>). In most nestbox studies, ringing and recapturing of breeding birds are conducted in tandem as part of the same protocol, and we can consequently approximate adult ringing probability using recapture probability (as used in the likelihood for capture histories): <span class="math inline">\(p_t^{ImmDetect} = p_t^{CapB}\)</span>). In a few exceptional years in some datasets, however, adult birds may have been ringed, but no recaptures recorded (i.e.Â <span class="math inline">\(p_t^{CapB}=0\)</span> but <span class="math inline">\(p_t^{ImmDetect}&gt;0\)</span>). These cases call for estimation of (or, in other words, accounting for the uncertainty in) the corresponding <span class="math inline">\(p_t^{ImmDetect}&gt;0\)</span>. As long as such cases are relatively few, this can be accommodated by specifying a non-informative prior for the unknown value<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="IPMCon.html#cb10-1"></a><span class="co">## Immigrant detection (= marking) probability</span></span>
<span id="cb10-2"><a href="IPMCon.html#cb10-2"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb10-3"><a href="IPMCon.html#cb10-3"></a>  PropImmDetect[t] <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-4"><a href="IPMCon.html#cb10-4"></a>}</span></code></pre></div>
<p>The latent number of breeding immigrants, informed by data as outlined above, is estimated as pooled across age classes (<span class="math inline">\(ImmNoTot_t\)</span>), but the since the population model in <code>SPI-IPM</code> is age structured <span class="math inline">\(ImmNoTot_t = ImmB_{Y,t} +ImmB_{A,t}\)</span>, where <span class="math inline">\(ImmB_{Y,t}\)</span> and <span class="math inline">\(ImmB_{A,t}\)</span> the numbers of breeding yearling and adult immigrants, respectively. These quantities are linked to the total numbers of immigrants in each age class (breeding and non-breeding), <span class="math inline">\(Imm_{a,t}\)</span>, that appear in the age-structured population model (<a href="##%20Open%20population%20model%20with%202%20age%20classes">Chapter 2.1</a> through age-specific breeding probabilities.
By assuming equal breeding probabilities for locally recruited and newly immigrated females, we can use the breeding probabilities estimated via the mark-recapture likelihood (<span class="math inline">\(pB_{a,t}\)</span>) to make the connection:
<span class="math display">\[\begin{equation}
  ImmB_{a,t} \sim Binomial(Imm_{a,t}, pB_{a,t})
\end{equation}\]</span></p>
<p>In the code, the sub-model for immigration contains both the likelihood for the immigrant count data pooled across ages and the relationship between breeding immigrant females and all immigrant females in both age classes:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="IPMCon.html#cb11-1"></a><span class="co">## Likelihood for the number/age distribution of immigrant females</span></span>
<span id="cb11-2"><a href="IPMCon.html#cb11-2"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>Tmax){</span>
<span id="cb11-3"><a href="IPMCon.html#cb11-3"></a></span>
<span id="cb11-4"><a href="IPMCon.html#cb11-4"></a>  <span class="co"># Latent true number of breeding immigrants (count observation model)</span></span>
<span id="cb11-5"><a href="IPMCon.html#cb11-5"></a>  ImmNoObs[t] <span class="op">~</span><span class="st"> </span><span class="kw">dpois</span>(<span class="kw">sum</span>(ImmB[<span class="dv">1</span><span class="op">:</span>A,t])<span class="op">*</span>PropImmDetect[t])</span>
<span id="cb11-6"><a href="IPMCon.html#cb11-6"></a></span>
<span id="cb11-7"><a href="IPMCon.html#cb11-7"></a>  <span class="co"># Number of breeding immigrants per age class</span></span>
<span id="cb11-8"><a href="IPMCon.html#cb11-8"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb11-9"><a href="IPMCon.html#cb11-9"></a>    ImmB[a,t] <span class="op">~</span><span class="st"> </span><span class="kw">dbin</span>(pB[a,t], Imm[a,t])</span>
<span id="cb11-10"><a href="IPMCon.html#cb11-10"></a>  }</span>
<span id="cb11-11"><a href="IPMCon.html#cb11-11"></a>}</span>
<span id="cb11-12"><a href="IPMCon.html#cb11-12"></a></span>
<span id="cb11-13"><a href="IPMCon.html#cb11-13"></a>ImmNoObs[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-14"><a href="IPMCon.html#cb11-14"></a>ImmB[<span class="dv">1</span><span class="op">:</span>A,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span></code></pre></div>
<p>Note that various immigrant numbers are set to 0 at <span class="math inline">\(t=1\)</span> since there is no way of distinguishing between locally-born and newly immigrated birds in the first year of study.</p>
</div>
</div>
<div id="priors-and-constraints" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.3</span> Priors and constraints<a href="IPMCon.html#priors-and-constraints" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the model description above, all vital rate parameters, as well as initial
population size and immigrant numbers, appear as fully time- and age-dependent
parameters (i.e.Â indexed by <span class="math inline">\(t\)</span> = year and <span class="math inline">\(a\)</span> = age class). <code>SPI-IPM</code> is a
hierarchical model, meaning it also describes how demographic quantities vary
across time and age classes and requires priors for the parameters defining
these underlying processes. The priors in the modelâs standard implementation
are all non- or only weakly informative, but they can easily be replaced with
more informative priors if required (see e.g.Â Chapter <a href="##%20Including%20additional%20data%20and%20informative%20priors">8.2</a>).</p>
<p>Time- and age-dependence in all vital rates is expressed using generalized
mixed-effect models. The exact model structure for each vital rate,
including link function, is described in detail in Chapter <a href="#%20Modelling%20temporal%20variation">3</a>. Irrespective of the vital rate, the basic model parameters fall into
three categories: (age-specific) intercepts representing time-average vital
rates (<span class="math inline">\(\mu\)</span>), slope parameters for the effects of temporal covariates (<span class="math inline">\(\beta\)</span>),
and standard deviations describing the distribution of random year effects
(<span class="math inline">\(\sigma\)</span>).
The intercept parameters <span class="math inline">\(\mu\)</span> are defined on the natural scale to allow for
more intuitive setting of priors. As such, non-informative Uniform(0,1) priors
can be used for the <span class="math inline">\(\mu\)</span> of all vital rates representing probabilities
(<span class="math inline">\(\mu_a^{pB}\)</span>, <span class="math inline">\(\mu^{pNS}\)</span>, <span class="math inline">\(\mu_a^{sN}\)</span>, <span class="math inline">\(\mu^{sJ}\)</span>, and <span class="math inline">\(\mu^{sA}\)</span>). For the
age-specific average clutch size (<span class="math inline">\(\mu_a^{CS}\)</span>), we use a Uniform(0,10) prior.
This latter prior is not completely uninformative, as it sets an upper limit of
10 eggs for the average clutch size (this is reasonable for pied flycatchers
 for which <code>SPI-IPM</code> was initially developed, but
may have to be adjusted for species that lay larger clutches).
All slope parameters <span class="math inline">\(\beta\)</span> are given Uniform(-5,5) priors, and all <span class="math inline">\(\sigma\)</span>
parameters (except for the one linked to immigration, <span class="math inline">\(\sigma_a^{Imm}\)</span>) are
given Uniform(0,10) priors.</p>
<p>Priors and constraints are also required for the initial population size, i.e.
<span class="math inline">\(N_{Y,1}\)</span> and <span class="math inline">\(N_{A,1}\)</span> since the population process model only begins
predicting <span class="math inline">\(N\)</span> from the second year (<span class="math inline">\(t=2\)</span>) onward. Immigrant numbers have their
own set of priors (see below), and since <span class="math inline">\(N_{a,t} = localN_{a,t} + Imm_{a,t}\)</span>,
priors have to be set for <span class="math inline">\(localN_{a,1}\)</span> specifically. <code>SPI-IPM</code> uses what is
essentially a discrete uniform prior for initial local population size:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="IPMCon.html#cb12-1"></a><span class="co">## Initial population sizes</span></span>
<span id="cb12-2"><a href="IPMCon.html#cb12-2"></a></span>
<span id="cb12-3"><a href="IPMCon.html#cb12-3"></a><span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb12-4"><a href="IPMCon.html#cb12-4"></a>  localN[a,<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dcat</span>(DU.prior[<span class="dv">1</span><span class="op">:</span>N1.limit])</span>
<span id="cb12-5"><a href="IPMCon.html#cb12-5"></a>  N[a,<span class="dv">1</span>] &lt;-<span class="st"> </span>localN[a,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>Imm[a,<span class="dv">1</span>]</span>
<span id="cb12-6"><a href="IPMCon.html#cb12-6"></a>}</span>
<span id="cb12-7"><a href="IPMCon.html#cb12-7"></a></span>
<span id="cb12-8"><a href="IPMCon.html#cb12-8"></a>DU.prior[<span class="dv">1</span><span class="op">:</span>N1.limit] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>N1.limit</span></code></pre></div>
<p>Here, <code>N1.limit</code> is a user-specified maximum possible number of local females in
any age class at the first time-step. The discrete uniform distribution is
approximated using a categorical distribution in which each integer number between
1 and <code>N1.limit</code> has the same probability (<code>1/N1.limit</code>) of occurring.
This approach is equivalent to using a regular Uniform(0,<code>N1.limit</code>) distribution
and subsequently rounding it.</p>
<p>The final set of priors and constraints in the model are for immigrant numbers
<span class="math inline">\(Imm_{Y,t}\)</span> and <span class="math inline">\(Imm_{A,t}\)</span>. At the first time-step (<span class="math inline">\(t=1\)</span>), immigrant numbers
are set to 0 (since there is no way of distinguishing previously local and
newly immigrated individuals in the first year of a study). Numbers at any
subsequent time-step are assumed to follow a 0-truncated normal distribution
with age-specific mean <span class="math inline">\(AvgImm_a\)</span> (<code>AvgImm[a]</code>) and standard deviation
<span class="math inline">\(\sigma_a^{Imm}\)</span> (<code>sigma.Imm[a])</code>):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="IPMCon.html#cb13-1"></a><span class="co">## Latent number of all immigrants (breeding &amp; non-breeding) per age class</span></span>
<span id="cb13-2"><a href="IPMCon.html#cb13-2"></a>Imm[<span class="dv">1</span><span class="op">:</span>A,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb13-3"><a href="IPMCon.html#cb13-3"></a></span>
<span id="cb13-4"><a href="IPMCon.html#cb13-4"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>Tmax){</span>
<span id="cb13-5"><a href="IPMCon.html#cb13-5"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb13-6"><a href="IPMCon.html#cb13-6"></a></span>
<span id="cb13-7"><a href="IPMCon.html#cb13-7"></a>    ImmCont[a,t] <span class="op">~</span><span class="st"> </span><span class="kw">T</span>(<span class="kw">dnorm</span>(AvgImm[a], <span class="dt">sd =</span> sigma.Imm[a]), <span class="dv">0</span>, <span class="ot">Inf</span>)</span>
<span id="cb13-8"><a href="IPMCon.html#cb13-8"></a>    Imm[a,t] &lt;-<span class="st"> </span><span class="kw">round</span>(ImmCont[a,t])</span>
<span id="cb13-9"><a href="IPMCon.html#cb13-9"></a>  }</span>
<span id="cb13-10"><a href="IPMCon.html#cb13-10"></a>}</span></code></pre></div>
<p>The rounding function ensures that immigrant numbers are integers.
Priors are then required for <span class="math inline">\(AvgImm_a\)</span> and <span class="math inline">\(\sigma_a^{Imm}\)</span>, and these are
given as uniform distributions with values ranging from 0 to (a multiple of) a
user-specified maximum possible number of immigrant females in any age class:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="IPMCon.html#cb14-1"></a><span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb14-2"><a href="IPMCon.html#cb14-2"></a>  AvgImm[a] <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, AvgImm.limit)</span>
<span id="cb14-3"><a href="IPMCon.html#cb14-3"></a>  sigma.Imm[a] <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, AvgImm.limit<span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb14-4"><a href="IPMCon.html#cb14-4"></a>}</span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-Caswell2001">
<p>Caswell, H. 2001. <em>Matrix population models: construction, analysis, and interpretation</em>. Sunderland, Mass.: Sinauer Associates.</p>
</div>
<div id="ref-cormack1964">
<p>Cormack, Richard M. 1964. âEstimates of Survival from the Sighting of Marked Animals.â <em>Biometrika</em> 51 (3/4): 429â38.</p>
</div>
<div id="ref-gimenez2007">
<p>Gimenez, Olivier, Vivien Rossi, RÃ©mi Choquet, Camille Dehais, Blaise Doris, Hubert Varella, Jean-Pierre Vila, and Roger Pradel. 2007. âState-Space Modelling of Data on Marked Individuals.â <em>Ecological Modelling</em> 206 (3-4): 431â38.</p>
</div>
<div id="ref-jolly1965">
<p>Jolly, George M. 1965. âExplicit Estimates from Capture-Recapture Data with Both Death and Immigration-Stochastic Model.â <em>Biometrika</em> 52 (1/2): 225â47.</p>
</div>
<div id="ref-kery2011">
<p>KÃ©ry, Marc, and Michael Schaub. 2011. <em>Bayesian Population Analysis Using Winbugs: A Hierarchical Perspective</em>. Academic Press.</p>
</div>
<div id="ref-seber1965">
<p>Seber, George AF. 1965. âA Note on the Multiple-Recapture Census.â <em>Biometrika</em> 52 (1/2): 249â59.</p>
</div>
<div id="ref-turek2016">
<p>Turek, Daniel, Perry de Valpine, and Christopher J Paciorek. 2016. âEfficient Markov Chain Monte Carlo Sampling for Hierarchical Hidden Markov Models.â <em>Environmental and Ecological Statistics</em> 23 (4): 549â64.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>For estimating only a subset of values within a vector/array (= partially observed variables), data (here <code>PropImmDetect[t]</code>) is provided including <code>NA</code> for unknown values and initial values are provided for the corresponding indeces (with initial values matching indeces of known data points being set to <code>NA</code>). Handling partially observed variables is discussed some more under <a href="###%20Imputation%20of%20missing%20covariate%20values">3.2.3 Imputation of missing covariate values</a><a href="IPMCon.html#fnref1" class="footnote-back">â©ï¸</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="DataPrep.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="TempVar.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-IPMCon.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPI-IPM_CodeManual.pdf", "SPI-IPM_CodeManual.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
