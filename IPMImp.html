<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 IPM Implementation | SPI-IPM Code Manual</title>
  <meta name="description" content="TBA." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 IPM Implementation | SPI-IPM Code Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TBA." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 IPM Implementation | SPI-IPM Code Manual" />
  
  <meta name="twitter:description" content="TBA." />
  

<meta name="author" content="Chloé R. Nater" />


<meta name="date" content="2022-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="TempVar.html"/>
<link rel="next" href="ModelAssm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPI-IPM Code Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this manual</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i>How to cite</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="DataPrep.html"><a href="DataPrep.html"><i class="fa fa-check"></i><b>1</b> Preparing SPI-Birds data for Bayesian analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-count-data"><i class="fa fa-check"></i><b>1.1</b> Nest count data</a></li>
<li class="chapter" data-level="1.2" data-path="DataPrep.html"><a href="DataPrep.html#clutch-size-data"><i class="fa fa-check"></i><b>1.2</b> Clutch size data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level"><i class="fa fa-check"></i><b>1.2.1</b> Nest level</a></li>
<li class="chapter" data-level="1.2.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level"><i class="fa fa-check"></i><b>1.2.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="DataPrep.html"><a href="DataPrep.html#fledgling-count-data"><i class="fa fa-check"></i><b>1.3</b> Fledgling count data</a><ul>
<li class="chapter" data-level="1.3.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level-1"><i class="fa fa-check"></i><b>1.3.1</b> Nest level</a></li>
<li class="chapter" data-level="1.3.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level-1"><i class="fa fa-check"></i><b>1.3.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="DataPrep.html"><a href="DataPrep.html#mark-recapture-data"><i class="fa fa-check"></i><b>1.4</b> Mark-recapture data</a><ul>
<li class="chapter" data-level="1.4.1" data-path="DataPrep.html"><a href="DataPrep.html#individual-capture-histories"><i class="fa fa-check"></i><b>1.4.1</b> Individual capture histories</a></li>
<li class="chapter" data-level="1.4.2" data-path="DataPrep.html"><a href="DataPrep.html#m-array"><i class="fa fa-check"></i><b>1.4.2</b> M-array</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="DataPrep.html"><a href="DataPrep.html#immigrant-count-data"><i class="fa fa-check"></i><b>1.5</b> Immigrant count data</a></li>
<li class="chapter" data-level="1.6" data-path="DataPrep.html"><a href="DataPrep.html#auxiliary-data-on-the-sampling-process"><i class="fa fa-check"></i><b>1.6</b> Auxiliary data on the sampling process</a><ul>
<li class="chapter" data-level="1.6.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-survey-sampling-effort"><i class="fa fa-check"></i><b>1.6.1</b> Nest survey sampling effort</a></li>
<li class="chapter" data-level="1.6.2" data-path="DataPrep.html"><a href="DataPrep.html#capture-probability-proxies"><i class="fa fa-check"></i><b>1.6.2</b> Capture probability proxies</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="DataPrep.html"><a href="DataPrep.html#organisation-for-analysis-with-nimble"><i class="fa fa-check"></i><b>1.7</b> Organisation for analysis with NIMBLE</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="IPMCon.html"><a href="IPMCon.html"><i class="fa fa-check"></i><b>2</b> IPM Construction</a><ul>
<li class="chapter" data-level="2.1" data-path="IPMCon.html"><a href="IPMCon.html#open-population-model-with-2-age-classes"><i class="fa fa-check"></i><b>2.1</b> Open population model with 2 age classes</a><ul>
<li class="chapter" data-level="2.1.1" data-path="IPMCon.html"><a href="IPMCon.html#model-description"><i class="fa fa-check"></i><b>2.1.1</b> Model description</a></li>
<li class="chapter" data-level="2.1.2" data-path="IPMCon.html"><a href="IPMCon.html#code-implementation-including-demographic-stochasticity"><i class="fa fa-check"></i><b>2.1.2</b> Code implementation including demographic stochasticity</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="IPMCon.html"><a href="IPMCon.html#data-likelihoods"><i class="fa fa-check"></i><b>2.2</b> Data likelihoods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="IPMCon.html"><a href="IPMCon.html#nest-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.1</b> Nest count data likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="IPMCon.html"><a href="IPMCon.html#clutch-size-data-likelihoods"><i class="fa fa-check"></i><b>2.2.2</b> Clutch size data likelihoods</a></li>
<li class="chapter" data-level="2.2.3" data-path="IPMCon.html"><a href="IPMCon.html#fledgling-count-data-likelihoods"><i class="fa fa-check"></i><b>2.2.3</b> Fledgling count data likelihoods</a></li>
<li class="chapter" data-level="2.2.4" data-path="IPMCon.html"><a href="IPMCon.html#mark-recapture-data-likelihood"><i class="fa fa-check"></i><b>2.2.4</b> Mark-recapture data likelihood</a></li>
<li class="chapter" data-level="2.2.5" data-path="IPMCon.html"><a href="IPMCon.html#immigrant-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.5</b> Immigrant count data likelihood</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="IPMCon.html"><a href="IPMCon.html#priors-and-constraints"><i class="fa fa-check"></i><b>2.3</b> Priors and constraints</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="TempVar.html"><a href="TempVar.html"><i class="fa fa-check"></i><b>3</b> Modelling temporal variation</a><ul>
<li class="chapter" data-level="3.1" data-path="TempVar.html"><a href="TempVar.html#random-year-variation"><i class="fa fa-check"></i><b>3.1</b> Random year variation</a></li>
<li class="chapter" data-level="3.2" data-path="TempVar.html"><a href="TempVar.html#temporal-covariates"><i class="fa fa-check"></i><b>3.2</b> Temporal covariates</a><ul>
<li class="chapter" data-level="3.2.1" data-path="TempVar.html"><a href="TempVar.html#continuous-variables"><i class="fa fa-check"></i><b>3.2.1</b> Continuous variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="TempVar.html"><a href="TempVar.html#categorical-variables"><i class="fa fa-check"></i><b>3.2.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="TempVar.html"><a href="TempVar.html#imputation-of-missing-covariate-values"><i class="fa fa-check"></i><b>3.2.3</b> Imputation of missing covariate values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="TempVar.html"><a href="TempVar.html#notes-on-covariate-selection"><i class="fa fa-check"></i><b>3.3</b> Notes on covariate selection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="IPMImp.html"><a href="IPMImp.html"><i class="fa fa-check"></i><b>4</b> IPM Implementation</a><ul>
<li class="chapter" data-level="4.1" data-path="IPMImp.html"><a href="IPMImp.html#efficient-implementation-using-nimble"><i class="fa fa-check"></i><b>4.1</b> Efficient implementation using NIMBLE</a><ul>
<li class="chapter" data-level="4.1.1" data-path="IPMImp.html"><a href="IPMImp.html#alternative-specification-of-distributions"><i class="fa fa-check"></i><b>4.1.1</b> Alternative specification of distributions</a></li>
<li class="chapter" data-level="4.1.2" data-path="IPMImp.html"><a href="IPMImp.html#vectorized-calculations"><i class="fa fa-check"></i><b>4.1.2</b> Vectorized calculations</a></li>
<li class="chapter" data-level="4.1.3" data-path="IPMImp.html"><a href="IPMImp.html#custom-distributions"><i class="fa fa-check"></i><b>4.1.3</b> Custom distributions</a></li>
<li class="chapter" data-level="4.1.4" data-path="IPMImp.html"><a href="IPMImp.html#calling-nimble-from-r"><i class="fa fa-check"></i><b>4.1.4</b> Calling NIMBLE from R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="IPMImp.html"><a href="IPMImp.html#simulation-of-initial-values"><i class="fa fa-check"></i><b>4.2</b> Simulation of initial values</a></li>
<li class="chapter" data-level="4.3" data-path="IPMImp.html"><a href="IPMImp.html#test-runs-and-full-runs-chains-iterations-burn-in-and-thinning"><i class="fa fa-check"></i><b>4.3</b> Test runs and full runs: chains, iterations, burn-in, and thinning</a></li>
<li class="chapter" data-level="4.4" data-path="IPMImp.html"><a href="IPMImp.html#trouble-shooting-implementation-issues"><i class="fa fa-check"></i><b>4.4</b> Trouble-shooting implementation issues</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ModelAssm.html"><a href="ModelAssm.html"><i class="fa fa-check"></i><b>5</b> Model Assessment</a><ul>
<li class="chapter" data-level="5.1" data-path="ModelAssm.html"><a href="ModelAssm.html#assessing-chain-convergence"><i class="fa fa-check"></i><b>5.1</b> Assessing chain convergence</a></li>
<li class="chapter" data-level="5.2" data-path="ModelAssm.html"><a href="ModelAssm.html#plotting-data-vs.-predictions"><i class="fa fa-check"></i><b>5.2</b> Plotting data vs. predictions</a></li>
<li class="chapter" data-level="5.3" data-path="ModelAssm.html"><a href="ModelAssm.html#comparing-estimates-from-integrated-vs.-independent-analyses"><i class="fa fa-check"></i><b>5.3</b> Comparing estimates from integrated vs. independent analyses</a></li>
<li class="chapter" data-level="5.4" data-path="ModelAssm.html"><a href="ModelAssm.html#reality-check-using-stochastic-simulations"><i class="fa fa-check"></i><b>5.4</b> “Reality check” using stochastic simulations</a></li>
<li class="chapter" data-level="5.5" data-path="ModelAssm.html"><a href="ModelAssm.html#other-approaches"><i class="fa fa-check"></i><b>5.5</b> Other approaches</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ResultsViz.html"><a href="ResultsViz.html"><i class="fa fa-check"></i><b>6</b> Visualizing and interpreting direct IPM outputs</a><ul>
<li class="chapter" data-level="6.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-trajectories"><i class="fa fa-check"></i><b>6.1</b> Population trajectories</a></li>
<li class="chapter" data-level="6.2" data-path="ResultsViz.html"><a href="ResultsViz.html#within-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.2</b> Within-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ResultsViz.html"><a href="ResultsViz.html#age-class-specific-averages"><i class="fa fa-check"></i><b>6.2.1</b> Age-class-specific averages</a></li>
<li class="chapter" data-level="6.2.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation"><i class="fa fa-check"></i><b>6.2.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ResultsViz.html"><a href="ResultsViz.html#between-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.3</b> Between-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-specific-averages"><i class="fa fa-check"></i><b>6.3.1</b> Population-specific averages</a></li>
<li class="chapter" data-level="6.3.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation-1"><i class="fa fa-check"></i><b>6.3.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ResultsViz.html"><a href="ResultsViz.html#covariate-effects"><i class="fa fa-check"></i><b>6.4</b> Covariate effects</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="AddAnalyses.html"><a href="AddAnalyses.html"><i class="fa fa-check"></i><b>7</b> Follow-up Analyses</a><ul>
<li class="chapter" data-level="7.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-time-trends"><i class="fa fa-check"></i><b>7.1</b> Testing for time-trends</a></li>
<li class="chapter" data-level="7.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-density-dependence"><i class="fa fa-check"></i><b>7.2</b> Testing for density-dependence</a></li>
<li class="chapter" data-level="7.3" data-path="AddAnalyses.html"><a href="AddAnalyses.html#investigating-cross-population-covariation"><i class="fa fa-check"></i><b>7.3</b> Investigating cross-population covariation</a></li>
<li class="chapter" data-level="7.4" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-short-term-population-dynamics"><i class="fa fa-check"></i><b>7.4</b> Quantifying demographic contributions to short term population dynamics</a><ul>
<li class="chapter" data-level="7.4.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-by-year-variation-in-population-growth-rate-random-design-ltre"><i class="fa fa-check"></i><b>7.4.1</b> Year-by-year variation in population growth rate (random design LTRE)</a></li>
<li class="chapter" data-level="7.4.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-to-year-differences-in-population-growth-rate-fixed-design-ltre"><i class="fa fa-check"></i><b>7.4.2</b> Year-to-year differences in population growth rate (fixed design LTRE)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-long-term-population-trends"><i class="fa fa-check"></i><b>7.5</b> Quantifying demographic contributions to long-term population trends</a><ul>
<li class="chapter" data-level="7.5.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#differences-in-population-trajectories-between-time-periods-period-design-ltre"><i class="fa fa-check"></i><b>7.5.1</b> Differences in population trajectories between time periods (period design LTRE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ExtOutlook.html"><a href="ExtOutlook.html"><i class="fa fa-check"></i><b>8</b> Useful extensions and outlook</a><ul>
<li class="chapter" data-level="8.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#adapting-the-population-model-for-your-speciespopulation"><i class="fa fa-check"></i><b>8.1</b> Adapting the population model for your species/population</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#accounting-for-multiple-broods-per-bird-per-year"><i class="fa fa-check"></i><b>8.1.1</b> Accounting for multiple broods per bird per year</a></li>
<li class="chapter" data-level="8.1.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#altering-age-structure"><i class="fa fa-check"></i><b>8.1.2</b> Altering age structure</a></li>
<li class="chapter" data-level="8.1.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#individual-heterogeneity-beyond-age-sex-traits-and-more"><i class="fa fa-check"></i><b>8.1.3</b> Individual heterogeneity beyond age: sex, traits, and more</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-additional-data-and-informative-priors"><i class="fa fa-check"></i><b>8.2</b> Including additional data and informative priors</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-partially-observed-age-information"><i class="fa fa-check"></i><b>8.2.1</b> Including partially observed age information</a></li>
<li class="chapter" data-level="8.2.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#making-the-most-of-auxiliary-knowledge-about-immigrantsdispersers"><i class="fa fa-check"></i><b>8.2.2</b> Making the most of auxiliary knowledge about immigrants/dispersers</a></li>
<li class="chapter" data-level="8.2.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#letting-published-values-help-with-estimation-when-data-is-sparse"><i class="fa fa-check"></i><b>8.2.3</b> Letting published values help with estimation when data is sparse</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#building-on-the-multi-population-perspective"><i class="fa fa-check"></i><b>8.3</b> Building on the multi-population perspective</a><ul>
<li class="chapter" data-level="8.3.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#joint-analysis-of-data-from-several-populations"><i class="fa fa-check"></i><b>8.3.1</b> Joint analysis of data from several populations</a></li>
<li class="chapter" data-level="8.3.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#modelling-cross-population-covariation"><i class="fa fa-check"></i><b>8.3.2</b> Modelling cross-population covariation</a></li>
<li class="chapter" data-level="8.3.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#estimating-hyper-parameters-in-large-scale-analyses"><i class="fa fa-check"></i><b>8.3.3</b> Estimating hyper-parameters in large-scale analyses</a></li>
<li class="chapter" data-level="8.3.4" data-path="ExtOutlook.html"><a href="ExtOutlook.html#unlocking-the-secrets-of-dispersal"><i class="fa fa-check"></i><b>8.3.4</b> Unlocking the secrets of dispersal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SPI-IPM Code Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="IPMImp" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 4</span> IPM Implementation<a href="IPMImp.html#IPMImp" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="efficient-implementation-using-nimble" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.1</span> Efficient implementation using NIMBLE<a href="IPMImp.html#efficient-implementation-using-nimble" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>SPI-IPM</code> is implemented in a Bayesian framework and, more specifically, it is
fit using NIMBLE <span class="citation">(de Valpine et al. <a href="#ref-devalpine2017" role="doc-biblioref">2017</a>)</span>. In many ways, NIMBLE is the successor to
BUGS and JAGS, using very similar syntax but offering higher efficiency, much
more flexibility, and a range of smaller “quality-of-life improvements”.
Unlike its predecessors, NIMBLE is not a software on its own and is installed
via the R-package <code>nimble</code> <span class="citation">(de Valpine et al. <a href="#ref-nimbleR" role="doc-biblioref">2021</a>)</span>. A lot of resources on setting up and
working with NIMBLE are available on the <a href="https://r-nimble.org/">NIMBLE website</a>
and this manual will not give a comprehensive overview of NIMBLE or the
<code>nimble</code> R package.
In the following, I will instead briefly outline some of
NIMBLE’s features that <code>SPI-IPM</code> makes use of, and that may be good to be aware
of particularly for people switching over from BUGS/JAGS. I will also briefly
outline the structure for the basic call to NIMBLE to run a model.</p>
<div id="alternative-specification-of-distributions" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.1.1</span> Alternative specification of distributions<a href="IPMImp.html#alternative-specification-of-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, NIMBLE allows alternative specifications for statistical distributions
(see the <a href="https://r-nimble.org/manuals/NimbleUserManual.pdf">NIMBLE manual</a>
for an overview). This is particularly convenient for some commonly used
distributions such as the normal distribution, which had to be specified via
a mean and a precision (<span class="math inline">\(\tau\)</span>) in BUGS/JAGS. The latter was then often related
to the (some might say) more useful standard deviation (<span class="math inline">\(\sigma\)</span>):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="IPMImp.html#cb19-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb19-2"><a href="IPMImp.html#cb19-2"></a>  epsilon[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, tau)</span>
<span id="cb19-3"><a href="IPMImp.html#cb19-3"></a>}</span>
<span id="cb19-4"><a href="IPMImp.html#cb19-4"></a>tau &lt;-<span class="st"> </span><span class="kw">pow</span>(sigma, <span class="dv">-2</span>)</span>
<span id="cb19-5"><a href="IPMImp.html#cb19-5"></a>sigma <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span></code></pre></div>
<p>Looks familiar?<br />
NIMBLE allows to specify the distribution parameters exactly as above, but also
offers alternatives such as parameterisation by mean and standard deviation
directly, e.g.:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="IPMImp.html#cb20-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb20-2"><a href="IPMImp.html#cb20-2"></a>  epsilon[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> sigma)</span>
<span id="cb20-3"><a href="IPMImp.html#cb20-3"></a>}</span>
<span id="cb20-4"><a href="IPMImp.html#cb20-4"></a>sigma <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="vectorized-calculations" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.1.2</span> Vectorized calculations<a href="IPMImp.html#vectorized-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A second useful feature is vectorized calculation of deterministic nodes. At
some point, everyone has heard that when programming in <code>R</code>, vectorization
outperforms for-loops when it comes to efficiency and speed. In many cases, this
is also true for MCMC, and NIMBLE therefore supports vectorization of
calculations for deterministic nodes (i.e. nodes assigned via <code>&lt;-</code> in the code).
<code>SPI-IPM</code> uses vectorized calculations instead of for-loops in a variety of
cases, for example for defining the models underlying temporal variation in
vital rates:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="IPMImp.html#cb21-1"></a><span class="kw">logit</span>(pNS[<span class="dv">1</span><span class="op">:</span>Tmax]) &lt;-<span class="st"> </span><span class="kw">logit</span>(Mu.pNS) <span class="op">+</span><span class="st"> </span>beta1.pNS<span class="op">*</span>cov1[<span class="dv">1</span><span class="op">:</span>Tmax] <span class="op">+</span><span class="st"> </span>beta2.pNS<span class="op">*</span>cov2[<span class="dv">1</span><span class="op">:</span>Tmax] <span class="op">+</span><span class="st"> </span>epsilon.pNS[<span class="dv">1</span><span class="op">:</span>Tmax]</span></code></pre></div>
<p>instead of</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="IPMImp.html#cb22-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb22-2"><a href="IPMImp.html#cb22-2"></a>  <span class="kw">logit</span>(pNS[t]) &lt;-<span class="st"> </span><span class="kw">logit</span>(Mu.pNS) <span class="op">+</span><span class="st"> </span>beta1.pNS<span class="op">*</span>cov1[t] <span class="op">+</span><span class="st"> </span>beta2.pNS<span class="op">*</span>cov2[t] <span class="op">+</span><span class="st"> </span>epsilon.pNS[t]</span>
<span id="cb22-3"><a href="IPMImp.html#cb22-3"></a>}</span></code></pre></div>
<p>It is important to note that vectorization works for deterministic nodes, but
– per today – not for stochastic nodes (i.e. nodes assigned via <code>~</code>).</p>
</div>
<div id="custom-distributions" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.1.3</span> Custom distributions<a href="IPMImp.html#custom-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The third class of NIMBLE features that <code>SPI-IPM</code> capitalizes on is the ability
to define custom distributions. Specifically, <code>SPI-IPM</code> uses a custom distribution
in the likelihood for the mark-recapture data.<br />
In most IPMs, the analysis of mark-recapture data to estimate survival represents
the bottleneck for MCMC efficiency: sampling hundreds – if not thousands – of
latent alive or dead states is computationally expensive and results in long
MCMC runtimes <span class="citation">(Gimenez et al. <a href="#ref-gimenez2007" role="doc-biblioref">2007</a>)</span>.
Summarising individual capture histories into “m-arrays” has long been the only
way to reduce runtimes of Bayesian mark-recapture models <span class="citation">(Kéry and Schaub <a href="#ref-kery2011" role="doc-biblioref">2011</a>)</span>, but many
find this format less intuitive and it quickly becomes convoluted and impractical
when working with predictors/groups other than age class. With the rise of
NIMBLE, <span class="citation">Turek, de Valpine, and Paciorek (<a href="#ref-turek2016" role="doc-biblioref">2016</a>)</span> developed an approach to defining marginalized likelihoods
that integrate over latent states and lead to tremendous increases in MCMC
efficiency. Basic implementations of the marginalized likelihood for mark-recapture
models were included in the <code>nimbleEcology</code> R package <span class="citation">(Goldstein et al. <a href="#ref-nimbleEcol" role="doc-biblioref">2021</a>)</span>.<br />
<code>SPI-IPM</code> uses an extended version of the <code>dCJS_vv</code> distribution contained in
<code>nimbleEcology</code> which not only integrates over latent states, but also runs on
only unique – instead of all – capture histories <span class="citation">(analogous to the goose
example in Turek, de Valpine, and Paciorek <a href="#ref-turek2016" role="doc-biblioref">2016</a>)</span>. Preliminary tests have shown that mark-recapture models
with a likelihood specified using this distribution (<code>dCJS_vv_sum</code>) have very
similar runtimes as implementations using m-arrays for small to medium-sized
datasets, and outspeed m-array formulations in for larger datasets.<br />
The specification of the custom distribution is contained in <code>dCJS_CustomDist.R</code>
and its implementation within the model code looks quite minimalistic:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="IPMImp.html#cb23-1"></a><span class="co">## Likelihood with custom distribution</span></span>
<span id="cb23-2"><a href="IPMImp.html#cb23-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.CH){</span>
<span id="cb23-3"><a href="IPMImp.html#cb23-3"></a>  y.sum[i, first.sum[i]<span class="op">:</span>last.sum[i]] <span class="op">~</span><span class="st"> </span><span class="kw">dCJS_vv_sum</span>(</span>
<span id="cb23-4"><a href="IPMImp.html#cb23-4"></a>       <span class="dt">probSurvive =</span> phi.CH[i, first.sum[i]<span class="op">:</span>last.sum[i]],</span>
<span id="cb23-5"><a href="IPMImp.html#cb23-5"></a>       <span class="dt">probCapture =</span> p.CH[i, first.sum[i]<span class="op">:</span>last.sum[i]],</span>
<span id="cb23-6"><a href="IPMImp.html#cb23-6"></a>       <span class="dt">len =</span> last.sum[i]<span class="op">-</span>first.sum[i]<span class="op">+</span><span class="dv">1</span>,</span>
<span id="cb23-7"><a href="IPMImp.html#cb23-7"></a>       <span class="dt">mult =</span> CHs.count[i])</span>
<span id="cb23-8"><a href="IPMImp.html#cb23-8"></a>}</span></code></pre></div>
<p><code>y.sum</code> is a matrix containing all <code>n.CH</code> unique capture histories and the
likelihood is fit for the range of observations between the first capture of an
individual (<code>first.sum</code>) and the last possible time this individual could still
have been alive<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>(<code>last.sum</code>). <code>probSurvive</code> and
<code>probCapture</code> are vectors containing the survival and recapture probabilities
relevant for the capture history (see <code>IPMSetup.R</code> and Chapter <a href="###%20Mark-recapture%20data%20likelihood">2.2.4</a> for details). The argument <code>len</code> quantifies the length of <code>y.sum</code>
and is required for successful compilation of the custom function. Finally, <code>mult</code>
is an integer number specifying how many individual birds shared capture history
<code>i</code>.</p>
</div>
<div id="calling-nimble-from-r" class="section level3 hasAnchor">
<h3><span class="header-section-number">4.1.4</span> Calling NIMBLE from R<a href="IPMImp.html#calling-nimble-from-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simplest way to implement and run a Bayesian model in NIMBLE is via the
wrapper-function <code>nimbleMCMC</code>. The structure of the <code>nimbleMCMC</code> call is very
similar to the functions provided with the different R-packages for running
BUGS/JAGS and – for <code>SPI-IPM</code> – looks like this (code line 49 in <code>IPMRun_PopID.R</code>):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="IPMImp.html#cb24-1"></a>SPI.IPM &lt;-<span class="st"> </span><span class="kw">nimbleMCMC</span>(<span class="dt">code =</span> SPI.IPMcode, <span class="dt">constants =</span> SPI.IPMconstants, <span class="dt">data =</span> SPI.IPMdata, <span class="dt">inits =</span> Inits, <span class="dt">monitors =</span> parameters, <span class="dt">niter =</span> ni, <span class="dt">nburnin =</span> nb, <span class="dt">nchains =</span> nc, <span class="dt">thin =</span> nt, <span class="dt">setSeed =</span> mySeed, <span class="dt">samplesAsCodaMCMC =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><code>code</code> is the model code, formatted as <code>nimbleCode</code>. <code>constants</code> and <code>data</code>
contain all information relevant for parameterising the model, as well as all
the observational data (see Chapter <a href="##%20Organisation%20for%20analysis%20with%20NIMBLE">1.4</a>).
<code>inits</code> is a list of initial values that is described further below, and <code>monitors</code>
is a character vector containing the names of all paramters that should be
monitored. <code>niter</code>, <code>nburnin</code>, <code>nchains</code>, and <code>thin</code> are the numbers of iterations,
samples to discard as burn-in, number of chains, and thinning interval for the
MCMC. <code>setSeed</code> is absolutely crucial! By setting the seed within the call to
NIMBLE, your entire MCMC becomes reproducible which is invaluable also for
trouble-shooting. The final argument, <code>samplesAsCodaMCMC</code>, is for people like
me who like to get back raw samples and make their own summaries instead of
having the function return larger objects containing the samples along with
a variety of summaries and other stats.</p>
</div>
</div>
<div id="simulation-of-initial-values" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.2</span> Simulation of initial values<a href="IPMImp.html#simulation-of-initial-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As a general rule, all parameters that have priors provided for them within
Bayesian models also require initial values. For <code>SPI-IPM</code>, this applies to:</p>
<ul>
<li>Vital rate averages (<span class="math inline">\(\mu\)</span> /<code>Mu</code>)</li>
<li>Environmental effects on vital rates (<span class="math inline">\(\beta\)</span> /<code>beta</code>)</li>
<li>Standard deviation for year random effects on vital rates (<span class="math inline">\(\sigma\)</span> /<code>sigma</code>)</li>
<li>Initial population sizes (<code>localN[,1]</code>)</li>
<li>Average and standard deviation of immigrant numbers (<code>AvgImm</code>, <code>sigma.Imm</code>)</li>
<li>Missing covariate values (subset of <code>cov1</code>, <code>cov2</code>, <code>cov3</code>)</li>
<li>Missing observation probabilities (subset of <code>PropImmDetect</code>)</li>
</ul>
<p>Provided that initial values for all of these parameters have been provided,
NIMBLE is able to calculate initial values for all of the remaining downstream
nodes using the realtionships specified in the model code. In practice, however,
the more different data sources and sub-models are included in an integrated
model, the more likely it is that this “automatic” initialization of nodes will
result in conflicts, i.e. initial values that are not compatible with each other.</p>
<p>While it may work for a single IPM to re-sample initial values repeatedly until
a set without conflicts has been found by chance, this is vastly impractical for
a framework like <code>SPI-IPM</code> which is designed to also work well for comparative
analyses, i.e. may be run on several datasets/populations at a time.<br />
For that reason, manual initialization of all nodes makes sense for <code>SPI-IPM</code> and
is implemented in the function <code>SPI_IPM.inits</code> (in file <code>InitSim.R</code>).</p>
<p>The function runs a simulation of the entire population model, including the
reconstruction of missing covariate and detection parameter values in four
steps:</p>
<ol style="list-style-type: decimal">
<li>Simulation of missing covariate values</li>
<li>Simulation of age- and time-specific vital rates</li>
<li>Simulation of initial population size and population trajectory over the study period, incl. immigration</li>
<li>Simulation of missing detection parameters</li>
</ol>
<p>The elements passed to the function are the collated data and constants
(<code>IPM.data</code> and <code>IPM.constants</code>, see Chapter <a href="##%20Organisation%20for%20analysis%20with%20NIMBLE">1.4</a>),
as well as a logical argument determining whether initial values for year random
effects should be sampled from their simulated distribution or set to 0 (<code>sampleRE</code>).</p>
<p>To sample initial values for several chains, the function is called multiple
times within a list.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="IPMImp.html#cb25-1"></a>Inits &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb25-2"><a href="IPMImp.html#cb25-2"></a>  <span class="kw">SPI_IPM.inits</span>(<span class="dt">IPM.data =</span> SPI.IPMdata, <span class="dt">IPM.constants =</span> SPI.IPMconstants, <span class="dt">sampleRE =</span> <span class="ot">FALSE</span>),</span>
<span id="cb25-3"><a href="IPMImp.html#cb25-3"></a>  <span class="kw">SPI_IPM.inits</span>(<span class="dt">IPM.data =</span> SPI.IPMdata, <span class="dt">IPM.constants =</span> SPI.IPMconstants, <span class="dt">sampleRE =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>is an example for initializing two chains.</p>
<p>Note that I am sampling the initial values and storing them in an object called
<code>Inits</code> in the example, which I then pass to <code>nimbleMCMC</code> afterwards, instead of
calling the <code>SPI_IPM.inits</code> directly within the call to <code>nimbleMCMC</code>. The reason
for “pre-sampling” initial values in this way is that it makes trouble-shooting
much easier: if initialization problems occur at specific nodes, I can
investigate both the associated data AND pre-sampled initial values to work out
the cause of the discrepancy.<br />
For the purpose of facilitating trouble-shooting, but also to promote reproducibility,
it is also good practice to set a seed prior to pre-sampling initial values
(in <code>IPMRun_PopID.R</code>, for example, the seed is set right at the start of the
script).</p>
</div>
<div id="test-runs-and-full-runs-chains-iterations-burn-in-and-thinning" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.3</span> Test runs and full runs: chains, iterations, burn-in, and thinning<a href="IPMImp.html#test-runs-and-full-runs-chains-iterations-burn-in-and-thinning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you have ample experience working with Bayesian models and MCMC, you can jump
over this section.</p>
<p>The following is a (perhaps obvious) practical tip for users that are newer to
Bayesian modelling and/or IPMs: always do a test-run of your implementation to
make sure it works before running a long MCMC!</p>
<p>In the original code, <code>SPI-IPM</code> is set up for a full run of 4 chains with
200 000 iterations each (see code lines 26-29 in <code>IPMRun_PopID.R</code>). The first
50 000 iterations of each chain are discarded as burn-in and the remainder
thinned by 30, resulting in a combined posterior consisting of 4<span class="math inline">\(\times\)</span> 5000 = 20 000
samples. This is rather generous, and it is not unlikely that your analysis will
require substantially less iterations to reach convergence (see Chapter
<a href="##%20Assessing%20chain%20convergence">5.1</a> for how to assess convergence).
Nonetheless, running the full MCMC can easily take several hours and ideally,
you would discover issues such as bad initialization or mistakes made during
code adjustments <strong>before</strong> having to wait that long.<br />
That’s where short test runs become useful. The shortest MCMC you can run is
two iterations long, no burn-in, and with thinning interval 1 (= no thinning).
By running that first, you can check that your model builds smoothly and contains
no unwanted NAs, and that initialization works as it should creates no conflicts.
With slightly more iterations in a test chain, you can also make sure that all
nodes that should be updating are in fact updating. Most importantly, this will
allow you to test your model’s setup and trouble-shoot some basic implementation
issues without having to wait for hours.</p>
</div>
<div id="trouble-shooting-implementation-issues" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.4</span> Trouble-shooting implementation issues<a href="IPMImp.html#trouble-shooting-implementation-issues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Specific content will be added later. In the meantime, a lot of helpful
information can be found in the materials on the <a href="https://r-nimble.org/">NIMBLE website</a>
and via the Google group <a href="https://groups.google.com/g/nimble-users">“nimble-users”</a>.</p>
<p>For issues that are related specifically to <code>SPI-IPM</code>, you can also get in touch
via <a href="mailto:chloe.nater@nina.no">email</a>.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-nimbleR">
<p>de Valpine, Perry, Christopher Paciorek, Daniel Turek, Nick Michaud, Cliff Anderson-Bergman, Fritz Obermeyer, Claudia Wehrhahn Cortes, Abel Rodrìguez, Duncan Temple Lang, and Sally Paganin. 2021. <em>NIMBLE: MCMC, Particle Filtering, and Programmable Hierarchical Modeling</em> (version 0.12.1). <a href="https://doi.org/10.5281/zenodo.1211190">https://doi.org/10.5281/zenodo.1211190</a>.</p>
</div>
<div id="ref-devalpine2017">
<p>de Valpine, Perry, Daniel Turek, Christopher J Paciorek, Clifford Anderson-Bergman, Duncan Temple Lang, and Rastislav Bodik. 2017. “Programming with Models: Writing Statistical Algorithms for General Model Structures with Nimble.” <em>Journal of Computational and Graphical Statistics</em> 26 (2): 403–13.</p>
</div>
<div id="ref-gimenez2007">
<p>Gimenez, Olivier, Vivien Rossi, Rémi Choquet, Camille Dehais, Blaise Doris, Hubert Varella, Jean-Pierre Vila, and Roger Pradel. 2007. “State-Space Modelling of Data on Marked Individuals.” <em>Ecological Modelling</em> 206 (3-4): 431–38.</p>
</div>
<div id="ref-nimbleEcol">
<p>Goldstein, Benjamin R., Daniel Turek, Lauren Ponisio, and Perry de Valpine. 2021. “nimbleEcology: Distributions for Ecological Models in nimble.” <a href="https://cran.r-project.org/package=nimbleEcology">https://cran.r-project.org/package=nimbleEcology</a>.</p>
</div>
<div id="ref-kery2011">
<p>Kéry, Marc, and Michael Schaub. 2011. <em>Bayesian Population Analysis Using Winbugs: A Hierarchical Perspective</em>. Academic Press.</p>
</div>
<div id="ref-turek2016">
<p>Turek, Daniel, Perry de Valpine, and Christopher J Paciorek. 2016. “Efficient Markov Chain Monte Carlo Sampling for Hierarchical Hidden Markov Models.” <em>Environmental and Ecological Statistics</em> 23 (4): 549–64.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>in practice this can be set to e.g. year of the last recorded
observation of the individual plus maximum lifesspan, plus some. In my analysis
of UK-breeding pied flycatchers, for example, I have set it – generously – to
20 years after the last recorded capture.<a href="IPMImp.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="TempVar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ModelAssm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-IPMImp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPI-IPM_CodeManual.pdf", "SPI-IPM_CodeManual.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
