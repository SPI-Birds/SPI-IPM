<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Modelling temporal variation | SPI-IPM Code Manual</title>
  <meta name="description" content="TBA." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Modelling temporal variation | SPI-IPM Code Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TBA." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Modelling temporal variation | SPI-IPM Code Manual" />
  
  <meta name="twitter:description" content="TBA." />
  

<meta name="author" content="Chloé R. Nater" />


<meta name="date" content="2022-08-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="IPMCon.html"/>
<link rel="next" href="IPMImp.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPI-IPM Code Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this manual</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i>How to cite</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="DataPrep.html"><a href="DataPrep.html"><i class="fa fa-check"></i><b>1</b> Preparing SPI-Birds data for Bayesian analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-count-data"><i class="fa fa-check"></i><b>1.1</b> Nest count data</a></li>
<li class="chapter" data-level="1.2" data-path="DataPrep.html"><a href="DataPrep.html#clutch-size-data"><i class="fa fa-check"></i><b>1.2</b> Clutch size data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level"><i class="fa fa-check"></i><b>1.2.1</b> Nest level</a></li>
<li class="chapter" data-level="1.2.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level"><i class="fa fa-check"></i><b>1.2.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="DataPrep.html"><a href="DataPrep.html#fledgling-count-data"><i class="fa fa-check"></i><b>1.3</b> Fledgling count data</a><ul>
<li class="chapter" data-level="1.3.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-level-1"><i class="fa fa-check"></i><b>1.3.1</b> Nest level</a></li>
<li class="chapter" data-level="1.3.2" data-path="DataPrep.html"><a href="DataPrep.html#population-level-1"><i class="fa fa-check"></i><b>1.3.2</b> Population level</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="DataPrep.html"><a href="DataPrep.html#mark-recapture-data"><i class="fa fa-check"></i><b>1.4</b> Mark-recapture data</a><ul>
<li class="chapter" data-level="1.4.1" data-path="DataPrep.html"><a href="DataPrep.html#individual-capture-histories"><i class="fa fa-check"></i><b>1.4.1</b> Individual capture histories</a></li>
<li class="chapter" data-level="1.4.2" data-path="DataPrep.html"><a href="DataPrep.html#m-array"><i class="fa fa-check"></i><b>1.4.2</b> M-array</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="DataPrep.html"><a href="DataPrep.html#immigrant-count-data"><i class="fa fa-check"></i><b>1.5</b> Immigrant count data</a></li>
<li class="chapter" data-level="1.6" data-path="DataPrep.html"><a href="DataPrep.html#auxiliary-data-on-the-sampling-process"><i class="fa fa-check"></i><b>1.6</b> Auxiliary data on the sampling process</a><ul>
<li class="chapter" data-level="1.6.1" data-path="DataPrep.html"><a href="DataPrep.html#nest-survey-sampling-effort"><i class="fa fa-check"></i><b>1.6.1</b> Nest survey sampling effort</a></li>
<li class="chapter" data-level="1.6.2" data-path="DataPrep.html"><a href="DataPrep.html#capture-probability-proxies"><i class="fa fa-check"></i><b>1.6.2</b> Capture probability proxies</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="DataPrep.html"><a href="DataPrep.html#organisation-for-analysis-with-nimble"><i class="fa fa-check"></i><b>1.7</b> Organisation for analysis with NIMBLE</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="IPMCon.html"><a href="IPMCon.html"><i class="fa fa-check"></i><b>2</b> IPM Construction</a><ul>
<li class="chapter" data-level="2.1" data-path="IPMCon.html"><a href="IPMCon.html#open-population-model-with-2-age-classes"><i class="fa fa-check"></i><b>2.1</b> Open population model with 2 age classes</a><ul>
<li class="chapter" data-level="2.1.1" data-path="IPMCon.html"><a href="IPMCon.html#model-description"><i class="fa fa-check"></i><b>2.1.1</b> Model description</a></li>
<li class="chapter" data-level="2.1.2" data-path="IPMCon.html"><a href="IPMCon.html#code-implementation-including-demographic-stochasticity"><i class="fa fa-check"></i><b>2.1.2</b> Code implementation including demographic stochasticity</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="IPMCon.html"><a href="IPMCon.html#data-likelihoods"><i class="fa fa-check"></i><b>2.2</b> Data likelihoods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="IPMCon.html"><a href="IPMCon.html#nest-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.1</b> Nest count data likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="IPMCon.html"><a href="IPMCon.html#clutch-size-data-likelihoods"><i class="fa fa-check"></i><b>2.2.2</b> Clutch size data likelihoods</a></li>
<li class="chapter" data-level="2.2.3" data-path="IPMCon.html"><a href="IPMCon.html#fledgling-count-data-likelihoods"><i class="fa fa-check"></i><b>2.2.3</b> Fledgling count data likelihoods</a></li>
<li class="chapter" data-level="2.2.4" data-path="IPMCon.html"><a href="IPMCon.html#mark-recapture-data-likelihood"><i class="fa fa-check"></i><b>2.2.4</b> Mark-recapture data likelihood</a></li>
<li class="chapter" data-level="2.2.5" data-path="IPMCon.html"><a href="IPMCon.html#immigrant-count-data-likelihood"><i class="fa fa-check"></i><b>2.2.5</b> Immigrant count data likelihood</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="IPMCon.html"><a href="IPMCon.html#priors-and-constraints"><i class="fa fa-check"></i><b>2.3</b> Priors and constraints</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="TempVar.html"><a href="TempVar.html"><i class="fa fa-check"></i><b>3</b> Modelling temporal variation</a><ul>
<li class="chapter" data-level="3.1" data-path="TempVar.html"><a href="TempVar.html#random-year-variation"><i class="fa fa-check"></i><b>3.1</b> Random year variation</a></li>
<li class="chapter" data-level="3.2" data-path="TempVar.html"><a href="TempVar.html#temporal-covariates"><i class="fa fa-check"></i><b>3.2</b> Temporal covariates</a><ul>
<li class="chapter" data-level="3.2.1" data-path="TempVar.html"><a href="TempVar.html#continuous-variables"><i class="fa fa-check"></i><b>3.2.1</b> Continuous variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="TempVar.html"><a href="TempVar.html#categorical-variables"><i class="fa fa-check"></i><b>3.2.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="TempVar.html"><a href="TempVar.html#imputation-of-missing-covariate-values"><i class="fa fa-check"></i><b>3.2.3</b> Imputation of missing covariate values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="TempVar.html"><a href="TempVar.html#notes-on-covariate-selection"><i class="fa fa-check"></i><b>3.3</b> Notes on covariate selection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="IPMImp.html"><a href="IPMImp.html"><i class="fa fa-check"></i><b>4</b> IPM Implementation</a><ul>
<li class="chapter" data-level="4.1" data-path="IPMImp.html"><a href="IPMImp.html#efficient-implementation-using-nimble"><i class="fa fa-check"></i><b>4.1</b> Efficient implementation using NIMBLE</a><ul>
<li class="chapter" data-level="4.1.1" data-path="IPMImp.html"><a href="IPMImp.html#alternative-specification-of-distributions"><i class="fa fa-check"></i><b>4.1.1</b> Alternative specification of distributions</a></li>
<li class="chapter" data-level="4.1.2" data-path="IPMImp.html"><a href="IPMImp.html#vectorized-calculations"><i class="fa fa-check"></i><b>4.1.2</b> Vectorized calculations</a></li>
<li class="chapter" data-level="4.1.3" data-path="IPMImp.html"><a href="IPMImp.html#custom-distributions"><i class="fa fa-check"></i><b>4.1.3</b> Custom distributions</a></li>
<li class="chapter" data-level="4.1.4" data-path="IPMImp.html"><a href="IPMImp.html#calling-nimble-from-r"><i class="fa fa-check"></i><b>4.1.4</b> Calling NIMBLE from R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="IPMImp.html"><a href="IPMImp.html#simulation-of-initial-values"><i class="fa fa-check"></i><b>4.2</b> Simulation of initial values</a></li>
<li class="chapter" data-level="4.3" data-path="IPMImp.html"><a href="IPMImp.html#test-runs-and-full-runs-chains-iterations-burn-in-and-thinning"><i class="fa fa-check"></i><b>4.3</b> Test runs and full runs: chains, iterations, burn-in, and thinning</a></li>
<li class="chapter" data-level="4.4" data-path="IPMImp.html"><a href="IPMImp.html#trouble-shooting-implementation-issues"><i class="fa fa-check"></i><b>4.4</b> Trouble-shooting implementation issues</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ModelAssm.html"><a href="ModelAssm.html"><i class="fa fa-check"></i><b>5</b> Model Assessment</a><ul>
<li class="chapter" data-level="5.1" data-path="ModelAssm.html"><a href="ModelAssm.html#assessing-chain-convergence"><i class="fa fa-check"></i><b>5.1</b> Assessing chain convergence</a></li>
<li class="chapter" data-level="5.2" data-path="ModelAssm.html"><a href="ModelAssm.html#plotting-data-vs.-predictions"><i class="fa fa-check"></i><b>5.2</b> Plotting data vs. predictions</a></li>
<li class="chapter" data-level="5.3" data-path="ModelAssm.html"><a href="ModelAssm.html#comparing-estimates-from-integrated-vs.-independent-analyses"><i class="fa fa-check"></i><b>5.3</b> Comparing estimates from integrated vs. independent analyses</a></li>
<li class="chapter" data-level="5.4" data-path="ModelAssm.html"><a href="ModelAssm.html#reality-check-using-stochastic-simulations"><i class="fa fa-check"></i><b>5.4</b> “Reality check” using stochastic simulations</a></li>
<li class="chapter" data-level="5.5" data-path="ModelAssm.html"><a href="ModelAssm.html#other-approaches"><i class="fa fa-check"></i><b>5.5</b> Other approaches</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ResultsViz.html"><a href="ResultsViz.html"><i class="fa fa-check"></i><b>6</b> Visualizing and interpreting direct IPM outputs</a><ul>
<li class="chapter" data-level="6.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-trajectories"><i class="fa fa-check"></i><b>6.1</b> Population trajectories</a></li>
<li class="chapter" data-level="6.2" data-path="ResultsViz.html"><a href="ResultsViz.html#within-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.2</b> Within-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ResultsViz.html"><a href="ResultsViz.html#age-class-specific-averages"><i class="fa fa-check"></i><b>6.2.1</b> Age-class-specific averages</a></li>
<li class="chapter" data-level="6.2.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation"><i class="fa fa-check"></i><b>6.2.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ResultsViz.html"><a href="ResultsViz.html#between-population-variation-in-vital-rates"><i class="fa fa-check"></i><b>6.3</b> Between-population variation in vital rates</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ResultsViz.html"><a href="ResultsViz.html#population-specific-averages"><i class="fa fa-check"></i><b>6.3.1</b> Population-specific averages</a></li>
<li class="chapter" data-level="6.3.2" data-path="ResultsViz.html"><a href="ResultsViz.html#year-by-year-variation-1"><i class="fa fa-check"></i><b>6.3.2</b> Year-by-year variation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ResultsViz.html"><a href="ResultsViz.html#covariate-effects"><i class="fa fa-check"></i><b>6.4</b> Covariate effects</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="AddAnalyses.html"><a href="AddAnalyses.html"><i class="fa fa-check"></i><b>7</b> Follow-up Analyses</a><ul>
<li class="chapter" data-level="7.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-time-trends"><i class="fa fa-check"></i><b>7.1</b> Testing for time-trends</a></li>
<li class="chapter" data-level="7.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#testing-for-density-dependence"><i class="fa fa-check"></i><b>7.2</b> Testing for density-dependence</a></li>
<li class="chapter" data-level="7.3" data-path="AddAnalyses.html"><a href="AddAnalyses.html#investigating-cross-population-covariation"><i class="fa fa-check"></i><b>7.3</b> Investigating cross-population covariation</a></li>
<li class="chapter" data-level="7.4" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-short-term-population-dynamics"><i class="fa fa-check"></i><b>7.4</b> Quantifying demographic contributions to short term population dynamics</a><ul>
<li class="chapter" data-level="7.4.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-by-year-variation-in-population-growth-rate-random-design-ltre"><i class="fa fa-check"></i><b>7.4.1</b> Year-by-year variation in population growth rate (random design LTRE)</a></li>
<li class="chapter" data-level="7.4.2" data-path="AddAnalyses.html"><a href="AddAnalyses.html#year-to-year-differences-in-population-growth-rate-fixed-design-ltre"><i class="fa fa-check"></i><b>7.4.2</b> Year-to-year differences in population growth rate (fixed design LTRE)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="AddAnalyses.html"><a href="AddAnalyses.html#quantifying-demographic-contributions-to-long-term-population-trends"><i class="fa fa-check"></i><b>7.5</b> Quantifying demographic contributions to long-term population trends</a><ul>
<li class="chapter" data-level="7.5.1" data-path="AddAnalyses.html"><a href="AddAnalyses.html#differences-in-population-trajectories-between-time-periods-period-design-ltre"><i class="fa fa-check"></i><b>7.5.1</b> Differences in population trajectories between time periods (period design LTRE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ExtOutlook.html"><a href="ExtOutlook.html"><i class="fa fa-check"></i><b>8</b> Useful extensions and outlook</a><ul>
<li class="chapter" data-level="8.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#adapting-the-population-model-for-your-speciespopulation"><i class="fa fa-check"></i><b>8.1</b> Adapting the population model for your species/population</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#accounting-for-multiple-broods-per-bird-per-year"><i class="fa fa-check"></i><b>8.1.1</b> Accounting for multiple broods per bird per year</a></li>
<li class="chapter" data-level="8.1.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#altering-age-structure"><i class="fa fa-check"></i><b>8.1.2</b> Altering age structure</a></li>
<li class="chapter" data-level="8.1.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#individual-heterogeneity-beyond-age-sex-traits-and-more"><i class="fa fa-check"></i><b>8.1.3</b> Individual heterogeneity beyond age: sex, traits, and more</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-additional-data-and-informative-priors"><i class="fa fa-check"></i><b>8.2</b> Including additional data and informative priors</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#including-partially-observed-age-information"><i class="fa fa-check"></i><b>8.2.1</b> Including partially observed age information</a></li>
<li class="chapter" data-level="8.2.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#making-the-most-of-auxiliary-knowledge-about-immigrantsdispersers"><i class="fa fa-check"></i><b>8.2.2</b> Making the most of auxiliary knowledge about immigrants/dispersers</a></li>
<li class="chapter" data-level="8.2.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#letting-published-values-help-with-estimation-when-data-is-sparse"><i class="fa fa-check"></i><b>8.2.3</b> Letting published values help with estimation when data is sparse</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#building-on-the-multi-population-perspective"><i class="fa fa-check"></i><b>8.3</b> Building on the multi-population perspective</a><ul>
<li class="chapter" data-level="8.3.1" data-path="ExtOutlook.html"><a href="ExtOutlook.html#joint-analysis-of-data-from-several-populations"><i class="fa fa-check"></i><b>8.3.1</b> Joint analysis of data from several populations</a></li>
<li class="chapter" data-level="8.3.2" data-path="ExtOutlook.html"><a href="ExtOutlook.html#modelling-cross-population-covariation"><i class="fa fa-check"></i><b>8.3.2</b> Modelling cross-population covariation</a></li>
<li class="chapter" data-level="8.3.3" data-path="ExtOutlook.html"><a href="ExtOutlook.html#estimating-hyper-parameters-in-large-scale-analyses"><i class="fa fa-check"></i><b>8.3.3</b> Estimating hyper-parameters in large-scale analyses</a></li>
<li class="chapter" data-level="8.3.4" data-path="ExtOutlook.html"><a href="ExtOutlook.html#unlocking-the-secrets-of-dispersal"><i class="fa fa-check"></i><b>8.3.4</b> Unlocking the secrets of dispersal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SPI-IPM Code Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="TempVar" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 3</span> Modelling temporal variation<a href="TempVar.html#TempVar" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Vital rates are expected to vary among years due to changes in environmental
conditions. <code>SPI-IPM</code> is set up to account for among-year variation in
different (age-specific) vital rates <span class="math inline">\(X_{a,t}\)</span> using fixed effects of
supplied environmental covariates (<span class="math inline">\(cov1_t\)</span>, <span class="math inline">\(cov2_t\)</span>,…) and year random effects (<span class="math inline">\(\epsilon_t^X\)</span>). The resulting generalized linear
mixed-models for time- and age-specific vital rates therefore take the following
form:
<span class="math display">\[\begin{equation}
  link(X_{a,t}) = link(\mu_a^X) + \beta_{cov1}^X\times cov1_t + \beta_{cov2}^X\times cov2_t + ... + \epsilon_t^X
\end{equation}\]</span>
Here, <span class="math inline">\(\mu_a^X\)</span> is the age-specific average vital rate (intercept) and <span class="math inline">\(\beta_{cov1}\)</span>
and <span class="math inline">\(\beta_{cov2}\)</span> are the slopes for the effects of covariates <span class="math inline">\(cov1\)</span> and <span class="math inline">\(cov2\)</span>
on the link scale, respectively.
The link function depends on the vital rate, and is set to logit for breeding
probabilities (<span class="math inline">\(pB_{a,t}\)</span>), nest success probabilities (<span class="math inline">\(pNS_t\)</span>), and survival
probabilities (<span class="math inline">\(sN_{a,t}\)</span>, <span class="math inline">\(sJ_t\)</span>, <span class="math inline">\(sA_t\)</span>) and log for clutch size (<span class="math inline">\(CS_{a,t}\)</span>).</p>
<div id="random-year-variation" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> Random year variation<a href="TempVar.html#random-year-variation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The random year effects included in the basic implementation of <code>SPI-IPM</code> are
assumed to be normally distributed such that
<span class="math display">\[\begin{equation}
  \epsilon_{t}^X \sim Normal(0, \sigma^X)
\end{equation}\]</span>
where <span class="math inline">\(\sigma^X\)</span> is the standard deviation of random year effects on vital rate
<span class="math inline">\(X_{a,t}\)</span>.
The random effects in the basic implementation are also age-independent, meaning
that <span class="math inline">\(\epsilon_t^X\)</span> is included in the equations for both the yearling vital
rate <span class="math inline">\(X_{Y,t}\)</span> and the adults vital rate <span class="math inline">\(X_{A,t}\)</span>. The exception are the annual
survival rates for juveniles (<span class="math inline">\(sJ_t\)</span>) and (<span class="math inline">\(sA_t\)</span>), which both have separate
random effects because the drivers of survival variation are expected to vary
between those two age classes, and the basic implementation includes an
additional covariate effect <span class="math inline">\(sJ_t\)</span> only<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="TempVar.html#cb15-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb15-2"><a href="TempVar.html#cb15-2"></a>    </span>
<span id="cb15-3"><a href="TempVar.html#cb15-3"></a>  <span class="co">## Age- and time-dependent survival probabilities</span></span>
<span id="cb15-4"><a href="TempVar.html#cb15-4"></a>  <span class="kw">logit</span>(sJ[t]) &lt;-<span class="st"> </span><span class="kw">logit</span>(Mu.sJ) <span class="op">+</span><span class="st"> </span>beta3.sJ<span class="op">*</span>cov3[t] <span class="op">+</span><span class="st"> </span>epsilon.sJ[t]</span>
<span id="cb15-5"><a href="TempVar.html#cb15-5"></a>  <span class="kw">logit</span>(sA[t]) &lt;-<span class="st"> </span><span class="kw">logit</span>(Mu.sA) <span class="op">+</span><span class="st"> </span>epsilon.sA[t]</span>
<span id="cb15-6"><a href="TempVar.html#cb15-6"></a></span>
<span id="cb15-7"><a href="TempVar.html#cb15-7"></a>  <span class="co">## Temporal random effects</span></span>
<span id="cb15-8"><a href="TempVar.html#cb15-8"></a>    epsilon.sJ[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> sigma.sJ)</span>
<span id="cb15-9"><a href="TempVar.html#cb15-9"></a>    epsilon.sA[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> sigma.sA)</span>
<span id="cb15-10"><a href="TempVar.html#cb15-10"></a>}</span></code></pre></div>
<p>All random effects are treated as independent (= not correlated) in the basic
implementation of the model, but the inclusion of correlation of random effects
across age-classes and/or vital rates is straightforward to implement<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> using e.g.
multivariate normal distributions or approaches similar to the one used in
<span class="citation">Nater et al. (<a href="#ref-nater2020" role="doc-biblioref">2020</a>)</span>.</p>
</div>
<div id="temporal-covariates" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> Temporal covariates<a href="TempVar.html#temporal-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic implementation of <code>SPI-IPM</code> features an example covariate model
structure that was motivated by an analysis of populations of pied flycatcher
(Ficedula hypoleuca)) breeding in the UK. It involves three different
covariates (<span class="math inline">\(cov1\)</span>, <span class="math inline">\(cov2\)</span>, and <span class="math inline">\(cov3\)</span>) that are assumed to affect nest success
probability (<span class="math inline">\(pNS_{t}\)</span>), nestling survival (<span class="math inline">\(sN_{a,t}\)</span>), and juvenile survival
(<span class="math inline">\(sJ_t\)</span>). However, it is very straightforward to alter the code to fit whatever
alternative covariate structure is suitable for your particular analysis since
the inclusion different/additional continuous and categorical covariates always
works according to the same principles <span class="citation">(see also Kéry and Schaub <a href="#ref-kery2011" role="doc-biblioref">2011</a>)</span>. All covariates are
need to be passed to <code>SPI-IPM</code> as vectors or arrays.</p>
<div id="continuous-variables" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.1</span> Continuous variables<a href="TempVar.html#continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Continuous variables are included as covariate effects using a specific slope
parameter (<span class="math inline">\(\beta\)</span>). Temporal effects then take the form
<span class="math inline">\(\beta_{cov1}\times cov1_t\)</span>, where <span class="math inline">\(\beta_{cov1}\)</span> is an estimated parameter
quantifying strength and direction of the effect and <span class="math inline">\(cov1_t\)</span> is the value of
covariate <span class="math inline">\(cov1\)</span> at time <span class="math inline">\(t\)</span>.
In (generalized) linear mixed effects models as they are used in <code>SPI-IPM</code>,
effects of several different covariates can just be added up on the link scale.
For <span class="math inline">\(pNS_t\)</span>, for example, this codes as<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="TempVar.html#cb16-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb16-2"><a href="TempVar.html#cb16-2"></a>  <span class="kw">logit</span>(pNS[t]) &lt;-<span class="st"> </span><span class="kw">logit</span>(Mu.pNS) <span class="op">+</span><span class="st"> </span>beta1.pNS<span class="op">*</span>cov1[t] <span class="op">+</span><span class="st"> </span>beta2.pNS<span class="op">*</span>cov2[t] <span class="op">+</span><span class="st"> </span>epsilon.pNS[t]</span>
<span id="cb16-3"><a href="TempVar.html#cb16-3"></a>}</span></code></pre></div>
<p>The basic implementation of <code>SPI-IPM</code> includes the following covariate models:
<span class="math display">\[\begin{align*}
  &amp; logit(pNS_t) = logit(\mu^{pNS}) + \beta_{cov1}^{pNS}\times cov1_t + \beta_{cov2}^{pNS} \times cov2_t + \epsilon_t^{pNS} \\
  &amp; logit(sN_{a,t}) = logit(\mu_a^{pNS}) + \beta_{cov1}^{sN}\times cov1_t + \beta_{cov2}^{sN} \times cov2_t + \epsilon_t^{sN} \\
  &amp; logit(sJ_t) = logit(\mu^{sJ}) + \beta_{cov3}^{sJ}\times cov3_t + \epsilon_t^{sJ}
\end{align*}\]</span>
All covariates are continuous annual variables that have been standardized and
centered (mean = 0, sd = 1) prior to analysis.
<span class="math inline">\(cov1\)</span> and <span class="math inline">\(cov2\)</span> represent environmental conditions during the incubation and
nestling period and hence influence nest success (<span class="math inline">\(pNS_t\)</span>) and nestling survival
(<span class="math inline">\(sN_{a,t}\)</span>). In the case of the latter, covariates are further assumed to have
the same magnitude of effect on the nests of yearling and adult females (i.e.
the <span class="math inline">\(\beta\)</span> parameters are independent of age). <span class="math inline">\(cov3\)</span>, on the other hand,
symbolizes environmental conditions after fledging which impact juvenile annual
survival (<span class="math inline">\(sJ_t\)</span>). No covariate effects are included for the other vital rates.</p>
</div>
<div id="categorical-variables" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.2</span> Categorical variables<a href="TempVar.html#categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The basic <code>SPI-IPM</code> does not include any categorical covariates, but since such
covariates may be relevant to a wide range of questions (e.g. some of the points
raised in Chapter <a href="##%20Adapting%20the%20population%20model%20for%20your%20species/population">8.2</a>),
I briefly illustrate how they could be included into vital rate models.</p>
<p>Generally, there are two approaches to modelling categorical covariates in this
context.</p>
<p>The first approach works analogous to the approach for continuous covariates,
i.e. it uses the form <span class="math inline">\(\beta_{cov}\times cov_t\)</span>. This is most relevant for
binary categorical covariates that symbolize some sort of “on-off” process. An
example of this would be if you would like to model the effect of an experimental
treatment that has been performed in some years (<span class="math inline">\(cov_t = 1\)</span>) but not others
(<span class="math inline">\(cov_t = 0\)</span>). Your binary covariate then works as a “switch” that determines
whether or not the effect of the experimental treatment (<span class="math inline">\(\beta_{cov}\)</span>) applied
in a given year <span class="math inline">\(t\)</span> or not since <span class="math inline">\(link(X_t) = link(\mu^X) + \beta_{cov_t}\times cov_t\)</span> becomes <span class="math inline">\(link(\mu^X) + \beta_{cov_t}\)</span> when <span class="math inline">\(cov_t = 1\)</span> and <span class="math inline">\(link(\mu^X)\)</span>
when <span class="math inline">\(cov_t = 0\)</span>.</p>
<p>The second approach works via (nested) indexing and is more flexible since it
can technically account for any number of levels in your categorical covariate.
This can be relevant, for example, for categories of years (“good”, “average”,
“bad”), habitat types (“deciduous forest”, “coniferous forest”), or individuals
(“male”, “female”).
The approach still uses <span class="math inline">\(\beta\)</span> parameters, but instead of multiplying the
<span class="math inline">\(\beta\)</span> with the covariate value, we index the <span class="math inline">\(\beta\)</span> by the covariate value
such that <span class="math inline">\(\beta_1\)</span> corresponds to the effect of category 1 (<span class="math inline">\(cat = 1\)</span>),
<span class="math inline">\(\beta_2\)</span> corresponds to the effect of category 2 (<span class="math inline">\(cat = 2\)</span>), and so on:</p>
<p><span class="math display">\[\begin{equation}
  link(X_{cat}) = link(\mu^X) + \beta_{cat}
\end{equation}\]</span>
Priors then need to be provided for each category-specific <span class="math inline">\(\beta\)</span>.</p>
<p>In practice, <code>SPI-IPM</code> still requires vital rates <span class="math inline">\(X\)</span> to be indexed by age class
and year (at least with the population model described in Chapter <a href="#%20IPM%20Construction">2</a>).
That’s where nested indexing becomes relevant.
The relationship of a vital rate <span class="math inline">\(X_{a,t}\)</span> with a categorical year covariate can,
for example, be coded as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="TempVar.html#cb17-1"></a><span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>A){</span>
<span id="cb17-2"><a href="TempVar.html#cb17-2"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb17-3"><a href="TempVar.html#cb17-3"></a>      <span class="kw">log</span>(X[a,t]) &lt;-<span class="st"> </span><span class="kw">log</span>(Mu.X[a]) <span class="op">+</span><span class="st"> </span>beta[cov[t]]</span>
<span id="cb17-4"><a href="TempVar.html#cb17-4"></a>  }</span>
<span id="cb17-5"><a href="TempVar.html#cb17-5"></a>  Mu.X <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb17-6"><a href="TempVar.html#cb17-6"></a>  beta <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb17-7"><a href="TempVar.html#cb17-7"></a>}</span></code></pre></div>
<p>where <code>cov[t]</code> is a vector of integer numbers that represent the different year
categories.</p>
<p>Introducing categorical effects that rely on additional structure beyond year
and age (for example effects of sex or location) requires changing the underlying
population model. Such extensions are currently not implemented in <code>SPI-IPM</code>,
but see Chapter <a href="#%20Useful%20extensions%20and%20outlook">8</a> for some perspectives.</p>
</div>
<div id="imputation-of-missing-covariate-values" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.3</span> Imputation of missing covariate values<a href="TempVar.html#imputation-of-missing-covariate-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Perhaps you have been wondering about how to deal with NAs in your covariate
data? The good news is that <code>SPI-IPM</code> (just like any other Bayesian
hierarchical model) can accommodate NAs in both continuous and categorical
covariates. The (perhaps) less good news is that how well it works really
depends on how large a proportion of your covariate data is NA.</p>
<p>There are three practical requirements for working with partially observed
covariate data:</p>
<ol style="list-style-type: decimal">
<li><p>Your covariate data containing numbers for your observed covariate values and NAs for your unobserved/unknown covariate values</p></li>
<li><p>Initial values with the same dimensions as your covariate data containing
numbers in the positions of NA covariate values and NAs in the positions of
observed covariate values.</p></li>
<li><p>A model describing the distribution of missing covariate values.</p></li>
</ol>
<p>Numbers 1. and 2. are pretty self-explanatory (but see Chapter <a href="##%20Simulation%20of%20initial%20values">4.2</a> for more information on sampling initial values).
Number 3. is going to depend on what type of covariate data you are dealing with.</p>
<p>The basic implementation of <code>SPI-IPM</code> is set up to be able to deal with NA
values in the continuous temporal covariates <span class="math inline">\(cov1\)</span>, <span class="math inline">\(cov2\)</span>, and <span class="math inline">\(cov3\)</span>. These
covariates are assumed to have been standardized and centered, i.e. they should
more or less follow a <span class="math inline">\(Normal(mean= 0, sd = 1)\)</span> distribution. If we assume that
the observed and unobserved covariate values follow the same distribution (i.e.
the missing values are a random subset of all values), this can be used to
specify the process model for the missing covariates in the code:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="TempVar.html#cb18-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tmax){</span>
<span id="cb18-2"><a href="TempVar.html#cb18-2"></a>  cov1[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-3"><a href="TempVar.html#cb18-3"></a>  cov2[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-4"><a href="TempVar.html#cb18-4"></a>  cov3[t] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-5"><a href="TempVar.html#cb18-5"></a>}</span></code></pre></div>
<p>There are numerous alternatives for specifying distributions of missing values
in continous covariates, and they can be accommodated by changing the above
section in the code.</p>
<p>The number of candidate distributions are a bit more limited when there are
missing values in categorical covariates.
Chapter <a href="###%20Including%20partially%20observed%20age%20information">8.2.1</a> outlines an
example for dealing with partially missing information on individual age. It
may also be helpful to remember that models with partially observed categorical
variables are essentially “mixture models” including auxiliary data about the
underlying distribution.</p>
</div>
</div>
<div id="notes-on-covariate-selection" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> Notes on covariate selection<a href="TempVar.html#notes-on-covariate-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be added later.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-kery2011">
<p>Kéry, Marc, and Michael Schaub. 2011. <em>Bayesian Population Analysis Using Winbugs: A Hierarchical Perspective</em>. Academic Press.</p>
</div>
<div id="ref-nater2020">
<p>Nater, Chloé R, Yngvild Vindenes, Per Aass, Diana Cole, Øystein Langangen, S Jannicke Moe, Atle Rustadbakken, Daniel Turek, Leif Asbjørn Vøllestad, and Torbjørn Ergon. 2020. “Size-and Stage-Dependence in Cause-Specific Mortality of Migratory Brown Trout.” <em>Journal of Animal Ecology</em> 89 (9): 2122–33.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Note that the implementation of this
in <code>IPMSetup.R</code> looks slightly different as it uses a vectorized formulation
(calculations done over all time-steps simultaneously instead of using a
for-loop). Vectorized calculations are a nifty feature available in NIMBLE (but
not BUGS and JAGS); more on this in Chapter <a href="##%20Efficient%20implementation%20using%20NIMBLE">4.1</a>.<a href="TempVar.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Wheter or
not formally including random effects correlations is useful or not depends on
the biological questions of interest and the amoung of data available. When
testing a model with correlated random effects for juvenile and adult survival
on seven datasets from breeding populations of pied flycatchers in the UK, I
found that estimates did not differ from those obtained from a model with
independent random effects, and the posterior distribution for the correlation
coefficient was so wide that no inference on strength or direction of the
correlation was possible.<a href="TempVar.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>see Footnote 1<a href="TempVar.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="IPMCon.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="IPMImp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-TempVar.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPI-IPM_CodeManual.pdf", "SPI-IPM_CodeManual.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
